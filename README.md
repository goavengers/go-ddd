# Go-DDD: Domain Driven Design, SAGA, Event-Sourcing & CQRS

## –ù–µ–º–Ω–æ–≥–æ —Ç–µ–æ—Ä–∏–∏

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ü–û ‚Äì —ç—Ç–æ –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã. –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, –æ–±–ª–∞–∫–∞, –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ—Ö–≤–∞—Ç ‚Äì –≤—Å–µ —ç—Ç–æ —Å—Ç–∞–ª–æ –Ω–æ—Ä–º–æ–π. –ù–æ –∑–∞ –∫—Ä–∞—Å–∏–≤—ã–º–∏ –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏ –∏ –º–æ–¥–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å. –ö–∞–∫ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –∫—É—á—É —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å –≤–º–µ—Å—Ç–µ –Ω–∞–¥–µ–∂–Ω–æ? –ö–∞–∫ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ, —Ä–∞–∑–º–∞–∑–∞–Ω–Ω—ã–µ –ø–æ —Å–µ—Ç–∏, –æ—Å—Ç–∞–Ω—É—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏? –≠—Ç–∞ –≥–æ–ª–æ–≤–Ω–∞—è –±–æ–ª—å –∑–Ω–∞–∫–æ–º–∞ –ª—é–±–æ–º—É, –∫—Ç–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–ª —Å–∏—Å—Ç–µ–º—ã —Å–ª–æ–∂–Ω–µ–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞, –±—É–¥—å —Ç–æ –≤ —Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º —Ñ–∏–Ω—Ç–µ—Ö–µ, –¥–∏–Ω–∞–º–∏—á–Ω–æ–º e-commerce –∏–ª–∏ –≥–¥–µ-–ª–∏–±–æ –µ—â–µ.

–ò –≤–æ—Ç —Ç—É—Ç –Ω–∞ –ø–æ–º–æ—â—å (–∏–ª–∏, —Å–∫–æ—Ä–µ–µ, –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª—è –±–æ—è) –ø—Ä–∏—Ö–æ–¥—è—Ç —Ç—Ä–∏ –ø–æ–Ω—è—Ç–∏—è: ACID, BASE –∏ —Ç–µ–æ—Ä–µ–º–∞ CAP. –ú–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è, —á—Ç–æ —ç—Ç–æ —Å—É—Ö–∞—è —Ç–µ–æ—Ä–∏—è, –Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏—Ö ‚Äì –≤—Å–µ —Ä–∞–≤–Ω–æ —á—Ç–æ –≤—ã—Ö–æ–¥–∏—Ç—å –≤ –º–æ—Ä–µ –±–µ–∑ –∫–æ–º–ø–∞—Å–∞ –∏ –∫–∞—Ä—Ç—ã. –≠—Ç–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∏–º–µ—Ç—å –¥–µ–ª–æ –∫–∞–∂–¥–æ–º—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä—É. –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∏—Ö ‚Äì –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—è —É—Å–ø–µ—Ö–∞, –Ω–æ –µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ.

### –ù–µ–∑—ã–±–ª–µ–º—ã–π ACID: –ö–ª–∞—Å—Å–∏–∫–∞ –∂–∞–Ω—Ä–∞ (–∏ –µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)

–ù–∞—á–Ω–µ–º —Å–æ —Å—Ç–æ–ª–ø–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è–º–∏ –¥–µ—Ä–∂–∞–ª–∏—Å—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. **–ß—Ç–æ –∂–µ –æ–±–µ—â–∞–µ—Ç –Ω–∞–º ACID? –ü–æ —Å—É—Ç–∏, —ç—Ç–æ —á–µ—Ç—ã—Ä–µ —Å—Ç–æ–ª–ø–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Å—Ç—Ä–æ–∏–ª–∞—Å—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö:**

- **–ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å (Atomicity):** –í—Å–µ –ø—Ä–æ—Å—Ç–æ ‚Äì –ª–∏–±–æ –≤—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ, –ª–∏–±–æ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–∞–∫, —Å–ª–æ–≤–Ω–æ –µ–µ –∏ –Ω–µ –∑–∞—Ç–µ–≤–∞–ª–∏. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –ø–µ—Ä–µ–≤–æ–¥ –¥–µ–Ω–µ–≥: —Å–ø–∏—Å–∞–ª–∏ —Ç—É—Ç, –∑–∞—á–∏—Å–ª–∏–ª–∏ —Ç–∞–º. –ù–µ–ª—å–∑—è –∑–∞—Å—Ç—Ä—è—Ç—å –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ. ACID –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–æ—Ç —ç—Ç–æ "–≤—Å–µ –∏–ª–∏ –Ω–∏—á–µ–≥–æ".
- **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (Consistency):** –¢—É—Ç –≤–∞–∂–Ω–æ –Ω–µ –ø—É—Ç–∞—Ç—å —Å 'C' –∏–∑ CAP! –í ACID —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ –Ω–∞—Ä—É—à–∏—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –≤–∞–º–∏ –ø—Ä–∞–≤–∏–ª –∏–≥—Ä—ã ‚Äì –≤—Å—è–∫–∏—Ö —Ç–∞–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏, —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏. –ë–∞–ª–∞–Ω—Å –Ω–µ —É–π–¥–µ—Ç –≤ –º–∏–Ω—É—Å, –µ—Å–ª–∏ –Ω–µ–ª—å–∑—è. –î–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –ª–æ–≥–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
- **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (Isolation):** –ú–∏—Ä –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–π, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ª–µ—Ç—è—Ç –ø–∞—á–∫–∞–º–∏. –ò–∑–æ–ª—è—Ü–∏—è ‚Äì —ç—Ç–æ —â–∏—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –¥–∞–µ—Ç –∏–º –Ω–∞—Å—Ç—É–ø–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥—É –Ω–∞ –ø—è—Ç–∫–∏ –∏ –≤–∏–¥–µ—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π '–±–µ—Å–ø–æ—Ä—è–¥–æ–∫' –¥—Ä—É–≥ –¥—Ä—É–≥–∞. –í –∏–¥–µ–∞–ª–µ (—É—Ä–æ–≤–µ–Ω—å Serializable) –≤—Å–µ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫, –±—É–¥—Ç–æ –æ–Ω–∏ –∏–¥—É—Ç —Å—Ç—Ä–æ–≥–æ –ø–æ –æ—á–µ—Ä–µ–¥–∏. –ù–∞ –¥–µ–ª–µ –º—ã —á–∞—Å—Ç–æ –∏–¥–µ–º –Ω–∞ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å—ã (–∏—Å–ø–æ–ª—å–∑—É–µ–º —É—Ä–æ–≤–Ω–∏ –∏–∑–æ–ª—è—Ü–∏–∏ –ø–æ–ø—Ä–æ—â–µ) —Ä–∞–¥–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏, –Ω–æ —Ü–µ–ª—å ‚Äì –Ω–µ –¥–∞—Ç—å –∏–º —Å–º–µ—à–∞—Ç—å –∫–∞—Ä—Ç—ã –¥—Ä—É–≥ –¥—Ä—É–≥—É.
- **–î–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å (Durability):** –°–∫–∞–∑–∞–Ω–æ ‚Äì —Å–¥–µ–ª–∞–Ω–æ, –∏ —Ç–æ—á–∫–∞. –ï—Å–ª–∏ –±–∞–∑–∞ –æ—Ç—á–∏—Ç–∞–ª–∞—Å—å –æ–± —É—Å–ø–µ—Ö–µ, –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–∂–∏–≤—É—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É, —Å–±–æ–π –ø–∏—Ç–∞–Ω–∏—è ‚Äì —á—Ç–æ —É–≥–æ–¥–Ω–æ, –∫—Ä–æ–º–µ —Å–æ–≤—Å–µ–º —É–∂ –∞–ø–æ–∫–∞–ª–∏–ø—Å–∏—Å–∞ –≤—Ä–æ–¥–µ –ø–æ–∂–∞—Ä–∞ –≤ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π. –ó–∞–ø–∏—Å—å –Ω–∞–¥–µ–∂–Ω–∞.

ACID ‚Äì —ç—Ç–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ. –≠—Ç–æ –∫–∞–∫ —Å–µ–π—Ñ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö. –ù–æ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞—Å—Ç—è–Ω—É—Ç—å —ç—Ç–æ—Ç —Å–µ–π—Ñ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–Ω–∞—Ç (—Å–µ—Ä–≤–µ—Ä–æ–≤), —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –∫–æ—Ä–∏–¥–æ—Ä–∞–º–∏ (—Å–µ—Ç—å—é). –û–±–µ—Å–ø–µ—á–∏—Ç—å —Ç—É –∂–µ –Ω–µ–ø—Ä–æ–±–∏–≤–∞–µ–º–æ—Å—Ç—å –º–µ–∂–¥—É –∫–æ–º–Ω–∞—Ç–∞–º–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —á–µ—Ä—Ç–æ–≤—Å–∫–∏ —Å–ª–æ–∂–Ω–æ. –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –≤—Ä–æ–¥–µ –¥–≤—É—Ö—Ñ–∞–∑–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ (2PC), –∫–æ—Ç–æ—Ä—ã–µ –ø—ã—Ç–∞—é—Ç—Å—è —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å, —Ç—Ä–µ–±—É—é—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –≤–æ –≤—Å–µ—Ö —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö "–∫–æ–º–Ω–∞—Ç–∞—Ö". –ï—Å–ª–∏ –æ–¥–Ω–∞ –∫–æ–º–Ω–∞—Ç–∞ –∑–∞–¥—É–º–∞–ª–∞—Å—å –∏–ª–∏ –∫–æ—Ä–∏–¥–æ—Ä –∫ –Ω–µ–π –ø–µ—Ä–µ–∫—Ä—ã–ª–∏ ‚Äì –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –≤—Å—Ç–∞–µ—Ç. –≠—Ç–æ –±—å–µ—Ç –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∑–∞–¥–µ—Ä–∂–∫–∏ —Ä–∞—Å—Ç—É—Ç) –∏, –≥–ª–∞–≤–Ω–æ–µ, –ø–æ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã. –¶–µ–Ω–∞ –∑–∞ —Å—Ç—Ä–æ–≥–∏–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π ACID —á–∞—Å—Ç–æ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–æ–π.

**–°–ª–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞ –Ω–∞—à–µ–º –ø—É—Ç–∏:**

1. **–§–∏–∑–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç —Å–≤–æ—é –±–∞–∑—É (Database per Service). –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—â–∞—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–∫–∏—Ö –±–∞–∑, –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–π ‚Äì –Ω—É–∂–Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –°–£–ë–î –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ —á–µ—Ä–µ–∑ —Å–µ—Ç–µ–≤—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã.
2. **–°–µ—Ç–µ–≤—ã–µ —Å–±–æ–∏ –∏ –∑–∞–¥–µ—Ä–∂–∫–∏:** –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ —Å–µ—Ç–∏ (REST, gRPC, —Å–æ–æ–±—â–µ–Ω–∏—è). –≠—Ç–æ –≤–Ω–æ—Å–∏—Ç –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–±–æ–µ–≤ —Å–≤—è–∑–∏. –î–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–≤—è–∑–∫—É –æ–ø–µ—Ä–∞—Ü–∏–π –∫–∞–∫ –µ–¥–∏–Ω—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, —Å–±–æ–π —Å–µ—Ç–∏ –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ç–æ–º—É, —á—Ç–æ —á–∞—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞, –∞ —á–∞—Å—Ç—å ‚Äì –Ω–µ—Ç.
3. **CAP-—Ç–µ–æ—Ä–µ–º–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:** –í —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –≤—ã–±–∏—Ä–∞—Ç—å –º–µ–∂–¥—É —Å—Ç—Ä–æ–≥–æ–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å—é –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é –ø—Ä–∏ —Å–±–æ—è—Ö —Å–≤—è–∑–∏. –ü–æ–ø—ã—Ç–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (—Å—Ç—Ä–æ–≥–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å) –∑–∞—á–∞—Å—Ç—É—é —É—Ö—É–¥—à–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: –µ—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç, –æ–±—â–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –∏–ª–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è. –î–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —ç—Ç–æ —É–∑–∫–æ–µ –º–µ—Å—Ç–æ.
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏:** –í –º–æ–Ω–æ–ª–∏—Ç–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã ‚Äì –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ –≤–ª–∏—è—é—Ç –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞. –í –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö –∂–µ, –±–µ–∑ –µ–¥–∏–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã –º–æ–≥—É—Ç —É–≤–∏–¥–µ—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞, –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–µ—Ç –æ–±—â–µ–π –∏–∑–æ–ª—è—Ü–∏–∏.

### –¢–µ–æ—Ä–µ–º–∞ CAP: –ñ–µ—Å—Ç–∫–∞—è –¥–∏–ª–µ–º–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∫–∏

–°—Ç–æ–ª–∫–Ω—É–≤—à–∏—Å—å —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ ACID, –∏–Ω–¥—É—Å—Ç—Ä–∏—è –æ–±—Ä–∞—Ç–∏–ª–∞—Å—å –∫ —Ç–µ–æ—Ä–µ–º–µ CAP. –û–Ω–∞ —Å—Ç–∞–ª–∞ —á–µ–º-—Ç–æ –≤—Ä–æ–¥–µ –∑–∞–∫–æ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –ò –Ω–µ—Ç, —ç—Ç–æ –Ω–µ "–≤—ã–±–µ—Ä–∏ –¥–≤–∞ –∏–∑ —Ç—Ä–µ—Ö", –∫–∞–∫ —á–∞—Å—Ç–æ –≥–æ–≤–æ—Ä—è—Ç. –í—Å–µ –Ω–µ–º–Ω–æ–≥–æ —Ö–∏—Ç—Ä–µ–µ. –¢–µ–æ—Ä–µ–º–∞ –æ–ø–µ—Ä–∏—Ä—É–µ—Ç —Ç—Ä–µ–º—è —Å–≤–æ–π—Å—Ç–≤–∞–º–∏:

- –¢—É—Ç **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (Consistency)** ‚Äì —ç—Ç–æ –ø—Ä–æ –¥—Ä—É–≥–æ–µ, —ç—Ç–æ —Ö–∞—Ä–¥–∫–æ—Ä. –≠—Ç–æ –∫–æ–≥–¥–∞ –ª—é–±–æ–µ —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç–∫—É–¥–∞ —É–≥–æ–¥–Ω–æ –≤—ã–¥–∞–µ—Ç —Å–∞–º—ã–π —Å–≤–µ–∂–∏–π, —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ö–∞–∫ –±—É–¥—Ç–æ –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∞–ª—å–Ω–æ –æ–¥–∏–Ω –Ω–∞ –≤—Å–µ—Ö, –∏ –≤—Å–µ –≤–∏–¥—è—Ç –µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.
- **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (Availability)** ‚Äì –∑–Ω–∞—á–∏—Ç, —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ —Å–≤—è–∑–∏. –í—ã —Å—Ç—É—á–∏—Ç–µ—Å—å –≤ –ª—é–±–æ–π –∂–∏–≤–æ–π —É–∑–µ–ª ‚Äì –æ–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –ø–æ —Å—É—â–µ—Å—Ç–≤—É, –∞ –Ω–µ –æ—à–∏–±–∫–æ–π "–ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ". –û–Ω –º–æ–∂–µ—Ç –æ—Ç–¥–∞—Ç—å –Ω–µ —Å–∞–º—ã–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ, –Ω–æ –æ–Ω –æ—Ç–≤–µ—á–∞–µ—Ç.
- **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—é (Partition Tolerance)** ‚Äì —ç—Ç–æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–∂–∏—Ç—å —Ä–∞—Å–∫–æ–ª —Å–µ—Ç–∏, –∫–æ–≥–¥–∞ —É–∑–ª—ã —Ç–µ—Ä—è—é—Ç —Å–≤—è–∑—å –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º. –ò –≤–æ—Ç —Ç—É—Ç –∑–∞–≥–≤–æ–∑–¥–∫–∞, —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –≤—ã–≤–æ–¥ –∏–∑ CAP: —ç—Ç–æ—Ç —Ä–∞—Å–∫–æ–ª —Å–µ—Ç–∏ (P) ‚Äì –Ω–µ –≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—à–∏–ª–∫–∞, –∞ –Ω–µ–∏–∑–±–µ–∂–Ω–∞—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å –ª—é–±–æ–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. –°–µ—Ç—å –±—É–¥–µ—Ç "–º–æ—Ä–≥–∞—Ç—å", –∏ —Å —ç—Ç–∏–º –Ω–∞–¥–æ –∂–∏—Ç—å.

–ò –≤–æ—Ç —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç —Ç–µ–æ—Ä–µ–º–∞ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ: **–∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–µ—Ç–µ–≤–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ (P), —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å –ª–∏–±–æ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å—é (C), –ª–∏–±–æ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é (A)**. –ù–µ–ª—å–∑—è –∏–º–µ—Ç—å –∏ —Ç–æ, –∏ –¥—Ä—É–≥–æ–µ **–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** –≤ –º–æ–º–µ–Ω—Ç —Ä–∞–∑—Ä—ã–≤–∞ —Å–≤—è–∑–∏.

- **–í—ã–±–∏—Ä–∞–µ—Ç–µ CP (Consistency –Ω–∞–¥ Availability):** –í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ —Ü–µ–Ω–∏—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ —É–∑–µ–ª –∏–∑-–∑–∞ —Ä–∞–∑–¥–µ–ª–∞ —Å–µ—Ç–∏ –Ω–µ –º–æ–∂–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –≤–∏–¥–∏—Ç —Å–∞–º—É—é —Å–≤–µ–∂—É—é –≤–µ—Ä—Å–∏—é –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —á—Ç–æ –µ–≥–æ –∑–∞–ø–∏—Å—å —É–≤–∏–¥—è—Ç –¥—Ä—É–≥–∏–µ, –æ–Ω –ø—Ä–µ–¥–ø–æ—á—Ç–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É –∏–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞—Ç—å –≤–æ–≤—Å–µ, –ª–∏—à—å –±—ã –Ω–µ –Ω–∞—Ä—É—à–∏—Ç—å –ª–∏–Ω–µ–∞—Ä–∏–∑—É–µ–º–æ—Å—Ç—å. –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –≥–∞—Ä–∞–Ω—Ç–∏—é C —Ü–µ–Ω–æ–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —á–∞—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –≤–æ –≤—Ä–µ–º—è P.
- **–í—ã–±–∏—Ä–∞–µ—Ç–µ AP (Availability –Ω–∞–¥ Consistency):** –í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ —Ü–µ–Ω–∏—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –î–∞–∂–µ –µ—Å–ª–∏ —É–∑–µ–ª –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω —Ä–∞–∑–¥–µ–ª–æ–º, –æ–Ω –ø—Ä–æ–¥–æ–ª–∂–∏—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã (–≤–æ–∑–º–æ–∂–Ω–æ, –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö) –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ (–∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Ç–æ–º –ø—Ä–∏–¥–µ—Ç—Å—è –∫–∞–∫-—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å). –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –≥–∞—Ä–∞–Ω—Ç–∏—é A —Ü–µ–Ω–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π (–∏–ª–∏ –¥–∞–∂–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π, –µ—Å–ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –Ω–µ —Ä–∞–∑—Ä–µ—à–∏—Ç—å) —Ä–∞—Å—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —á–∞—Å—Ç—è–º–∏ —Å–∏—Å—Ç–µ–º—ã –≤–æ –≤—Ä–µ–º—è P.

–ê —á—Ç–æ –∂–µ —Å–∏—Å—Ç–µ–º—ã CA (Consistency + Availability)? –û–Ω–∏ –≤–æ–∑–º–æ–∂–Ω—ã –ª–∏—à—å –≤ –≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–æ–º –º–∏—Ä–µ –±–µ–∑ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º. –ö–∞–∫ —Ç–æ–ª—å–∫–æ —Å–ª—É—á–∞–µ—Ç—Å—è P, –ª—é–±–∞—è CA-—Å–∏—Å—Ç–µ–º–∞ –≤—ã–Ω—É–∂–¥–µ–Ω–∞ –±—É–¥–µ—Ç –¥–µ–≥—Ä–∞–¥–∏—Ä–æ–≤–∞—Ç—å –ª–∏–±–æ –¥–æ CP, –ª–∏–±–æ –¥–æ AP.

### BASE: –ü—Ä–∞–≥–º–∞—Ç–∏–∑–º –≤ –º–∏—Ä–µ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞

–ò—Ç–∞–∫, –µ—Å–ª–∏ –≤—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é P –∏ –≤—ã–±—Ä–∞–ª–∏ A (–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å), –≤—ã –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–∏—Ö–æ–¥–∏—Ç–µ –∫ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º, –æ–ø–∏—Å—ã–≤–∞–µ–º—ã–º –∞–∫—Ä–æ–Ω–∏–º–æ–º BASE. –≠—Ç–æ –Ω–µ —Å—Ç—Ä–æ–≥–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç, –∞ —Å–∫–æ—Ä–µ–µ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ —É—Å–ª–æ–≤–∏—è—Ö —á–∞—Å—Ç–∏—á–Ω—ã—Ö –æ—Ç–∫–∞–∑–æ–≤ –∏ –Ω–µ—Å—Ç—Ä–æ–≥–æ–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏:

- **Basically Available (–ë–∞–∑–æ–≤–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å):** –°–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∞–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ–µ, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–∞–∫ –∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –≤—ã–±–æ—Ä 'A' –≤ CAP. –ú–æ–∂–µ—Ç –±—ã—Ç—å, –Ω–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∏–¥–µ–∞–ª—å–Ω–æ, –Ω–æ —Å–∏—Å—Ç–µ–º–∞ "–∂–∏–≤–∞".
- **Soft state (–ì–∏–±–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ):** –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –¥–∞–∂–µ –±–µ–∑ –ø—Ä—è–º–æ–≥–æ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–∑-–∑–∞ —Ñ–æ–Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ —É–∑–ª—ã –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ –ø—ã—Ç–∞—é—Ç—Å—è –ø—Ä–∏–π—Ç–∏ –∫ –µ–¥–∏–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –∫—ç—à–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è.
- **Eventually consistent (–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å—á–µ—Ç–µ):** –°–∞–º—ã–π –∏–∑–≤–µ—Å—Ç–Ω—ã–π –∏ —á–∞—Å—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–Ω–∏–º–∞–µ–º—ã–π –ø—Ä–∏–Ω—Ü–∏–ø BASE. –°–∏—Å—Ç–µ–º–∞ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ –≤—Å–µ —É–∑–ª—ã —É–≤–∏–¥—è—Ç –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –ù–æ –æ–Ω–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤ —ç—Ç–æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –¥–∞–Ω–Ω—ã—Ö –±–æ–ª—å—à–µ –Ω–µ –ø–æ—Å—Ç—É–ø–∞–µ—Ç, —Ç–æ —Ä–∞–Ω–æ –∏–ª–∏ –ø–æ–∑–¥–Ω–æ –≤—Å–µ —Ä–µ–ø–ª–∏–∫–∏ —ç—Ç–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Å–æ–π–¥—É—Ç—Å—è –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –∑–∞–ø–∏—Å–∞–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é. "–†–∞–Ω–æ –∏–ª–∏ –ø–æ–∑–¥–Ω–æ" ‚Äì –∫–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã, —Å–µ–∫—É–Ω–¥—ã –∏–ª–∏ –¥–∞–∂–µ –º–∏–Ω—É—Ç—ã, –∏ —ç—Ç–æ –≤—Ä–µ–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫–∞–∫-—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –∏–ª–∏ —Ö–æ—Ç—è –±—ã –Ω–∞–±–ª—é–¥–∞–µ–º–æ.

BASE ‚Äì —ç—Ç–æ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –≤–æ –º–Ω–æ–≥–∏—Ö —Å–ª—É—á–∞—è—Ö –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –Ω–µ –Ω—É–∂–Ω–∞ –∏ –µ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ –æ–±—Ö–æ–¥–∏—Ç—Å—è —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –õ–µ–Ω—Ç–∞ –Ω–æ–≤–æ—Å—Ç–µ–π, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ ‚Äì –∑–¥–µ—Å—å –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —á–∞—Å—Ç–æ –ø—Ä–∏–µ–º–ª–µ–º–∞. –≠—Ç–æ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥: –ø—Ä–∏–Ω–∏–º–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∞ –ø–æ—Ç–æ–º —Ä–∞–∑–±–∏—Ä–∞–µ–º—Å—è. –ù–æ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å: —Ä–∞–±–æ—Ç–∞—Ç—å —Å eventually consistent –¥–∞–Ω–Ω—ã–º–∏ —Å–ª–æ–∂–Ω–µ–µ, –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏ —á—Ç–µ–Ω–∏—è (–ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –Ω–æ–≤—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä).

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–∞–∫ –∏—Å–∫—É—Å—Å—Ç–≤–æ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å–∞: –ü—Ä–∏–º–µ–Ω—è–µ–º ACID/BASE/CAP

–ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–∏—Ö —Ç—Ä–µ—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π ‚Äì —ç—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–æ. –ù–∞—Å—Ç–æ—è—â–∞—è —Ä–∞–±–æ—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ ‚Äì –ø—Ä–∏–º–µ–Ω—è—Ç—å –∏—Ö –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π:

1. **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è ‚Äì –≤–æ –≥–ª–∞–≤–µ —É–≥–ª–∞:** –í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å –≤–æ–ø—Ä–æ—Å–∞ "–ß—Ç–æ –Ω—É–∂–Ω–æ –±–∏–∑–Ω–µ—Å—É –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é?". –ù–∞—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ—Ç–µ—Ä—è –∏–ª–∏ —Ä–∞—Å—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö? –ö–∞–∫–æ–≤–∞ —Ü–µ–Ω–∞ –æ—à–∏–±–∫–∏? –ö–∞–∫–æ–≤—ã –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫–ª–∏–∫–∞? –û—Ç–≤–µ—Ç—ã –Ω–∞ —ç—Ç–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ–º–æ–≥—É—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –Ω—É–∂–Ω–∞ –ª–∏ –≤–∞–º –∫—Ä–µ–ø–æ—Å—Ç—å ACID –∏–ª–∏ –≥–∏–±–∫–æ—Å—Ç—å BASE –¥–ª—è –¥–∞–Ω–Ω–æ–π —á–∞—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã. –ò —É–º–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è CAP –Ω–∞ —è–∑—ã–∫ –±–∏–∑–Ω–µ—Å-—Ä–∏—Å–∫–æ–≤ ‚Äì –≤–∞–∂–Ω—ã–π –Ω–∞–≤—ã–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞.
2. **–í—ã–±–æ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π:** –†–µ—à–µ–Ω–∏–µ –æ –°–£–ë–î, –±—Ä–æ–∫–µ—Ä–µ —Å–æ–æ–±—â–µ–Ω–∏–π, –∫—ç—à–µ ‚Äì —ç—Ç–æ –≤–æ –º–Ω–æ–≥–æ–º —Ä–µ—à–µ–Ω–∏–µ –æ –º–æ–¥–µ–ª–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏/–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏.
   - **–†–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –°–£–ë–î (Postgres, etc.):** –û–±—ã—á–Ω–æ –≤–∞—à –≤—ã–±–æ—Ä –¥–ª—è –¥–∞–Ω–Ω—ã—Ö, —Ç—Ä–µ–±—É—é—â–∏—Ö —Å—Ç—Ä–æ–≥–æ–≥–æ ACID. –í –∫–ª–∞—Å—Ç–µ—Ä–µ —á–∞—Å—Ç–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ CP.
   - **NoSQL:** –ó–¥–µ—Å—å —Ü–∞—Ä–∏—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ. Cassandra –∏ Riak —Å–ª–∞–≤—è—Ç—Å—è —Å–≤–æ–µ–π AP-–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–µ–π. MongoDB –∏ Couchbase –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –≥–∏–±–∫—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏. Key-value —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Ç–∏–ø–∞ Redis —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (AP). –í–∞–∂–Ω–æ —á–∏—Ç–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –ø–æ–Ω–∏–º–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Äì –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –°–£–ë–î –º–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É. –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–≤–æ—Ä—É–º–æ–≤ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –≤ Cassandra –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ –±–∞–ª–∞–Ω—Å C –∏ A.
3. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:** –ú–Ω–æ–≥–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã ‚Äì —ç—Ç–æ, –ø–æ —Å—É—Ç–∏, —Å–ø–æ—Å–æ–±—ã –æ–±–æ–π—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω—É–∂–Ω—É—é –º–æ–¥–µ–ª—å –ø–æ–≤–µ–¥–µ–Ω–∏—è:
   - **Saga:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ä–∫–µ—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–æ–ø–µ—Ä–∞—Ü–∏–∏, —Ä–∞–∑–±–∏–≤–∞—è –∏—Ö –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è–º–∏. –≠—Ç–æ —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∏—á—å –±–∏–∑–Ω–µ—Å-–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏ —Ç–∞–º, –≥–¥–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π ACID (2PC) –Ω–µ–ø—Ä–∞–∫—Ç–∏—á–µ–Ω –∏–∑-–∑–∞ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å.
   - **CQRS:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π –¥–ª—è –∫–æ–º–∞–Ω–¥ (–∑–∞–ø–∏—Å—å) –∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (—á—Ç–µ–Ω–∏–µ). –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–µ—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥—É—é –º–æ–¥–µ–ª—å –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é, –≤–æ–∑–º–æ–∂–Ω–æ, eventually consistent –º–æ–¥–µ–ª—å –¥–ª—è —á—Ç–µ–Ω–∏—è. –≠—Ç–æ –ø—Ä—è–º–æ–π –æ—Ç–≤–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏ —á—Ç–µ–Ω–∏—è —á–∞—Å—Ç–æ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è.
   - **Event Sourcing:** –ó–∞–ø–∏—Å—å –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–∞–∫ —Å–æ–±—ã—Ç–∏–π. –û—Ç–ª–∏—á–Ω–æ –ª–æ–∂–∏—Ç—Å—è –Ω–∞ CQRS –∏ –æ–±–ª–µ–≥—á–∞–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ eventually consistent –ø—Ä–æ–µ–∫—Ü–∏–π, –∞ —Ç–∞–∫–∂–µ –∞–Ω–∞–ª–∏–∑ –∏ –æ—Ç–ª–∞–¥–∫—É.
   - **–û—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (Kafka, RabbitMQ):** –°–µ—Ä–¥—Ü–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π, —Å–ª–∞–±–æ—Å–≤—è–∑–∞–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (AP/BASE). –ü–æ–∑–≤–æ–ª—è—é—Ç —Å–µ—Ä–≤–∏—Å–∞–º –æ–±—â–∞—Ç—å—Å—è –Ω–∞–¥–µ–∂–Ω–æ, –Ω–æ –±–µ–∑ –ø—Ä—è–º—ã—Ö –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –≤—ã–∑–æ–≤–æ–≤, —Å–≥–ª–∞–∂–∏–≤–∞—è –ø–∏–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è eventual consistency. –í–∞–∂–Ω–æ —Ç–∞–∫–∂–µ –¥—É–º–∞—Ç—å –æ–± –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π.
4. **–ñ–∏–∑–Ω—å —Å Partition Tolerance:** –ù—É–∂–Ω–æ –Ω–µ —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞—Ç—å CP/AP, –Ω–æ –∏ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∞ –º–æ–≥–ª–∞ –ø–µ—Ä–µ–∂–∏—Ç—å P. –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç:
   - –ù–∞–¥–µ–∂–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —É–∑–ª–æ–≤ –∏ —Å–µ—Ç–∏.
   - –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –¥–ª—è AP-—Å–∏—Å—Ç–µ–º (–∫—Ç–æ –ø–æ–±–µ–∂–¥–∞–µ—Ç –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏?).
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–¥–µ—Ä–∂–µ–∫ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –≤ BASE-—Å–∏—Å—Ç–µ–º–∞—Ö, —á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ "—Å—Ç–∞—Ä—ã–º–∏" –º–æ–≥—É—Ç –±—ã—Ç—å –¥–∞–Ω–Ω—ã–µ.
   - –ß–µ—Ç–∫–∏–µ –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —Ä–∞–∑–¥–µ–ª–æ–≤ —Å–µ—Ç–∏ –∏–ª–∏ –∞–Ω–æ–º–∞–ª—å–Ω–æ –±–æ–ª—å—à–∏—Ö –∑–∞–¥–µ—Ä–∂–µ–∫.

### –û—Å–æ–∑–Ω–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä

**ACID, BASE –∏ CAP** ‚Äì —ç—Ç–æ –Ω–µ –¥–æ–≥–º—ã, –∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º—ã—à–ª–µ–Ω–∏—è. –û–Ω–∏ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç –Ω–µ–∏–∑–±–µ–∂–Ω—ã–µ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å—ã –≤ —Å–ª–æ–∂–Ω–æ–º –º–∏—Ä–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –ù–µ—Ç "—Å–µ—Ä–µ–±—Ä—è–Ω–æ–π –ø—É–ª–∏". –¢–∞–∫ —á—Ç–æ —Ä–∞–±–æ—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ ‚Äì —ç—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –±–∞–ª–∞–Ω—Å–∞. –ò–¥–µ–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π —Ç—É—Ç –Ω–µ—Ç, –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –≤—ã–±–æ—Ä –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —Ä–∞–∑–º–µ–Ω–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏, —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö "—Ö–æ—Ç–µ–ª–æ–∫" –±–∏–∑–Ω–µ—Å–∞, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∞–ª–∏–π –∏ —Ç–æ–≥–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç. –≠—Ç–æ –≤—Å–µ–≥–¥–∞ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å, –∏ –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äì —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–º –∏ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–º.

## –≠–≤–æ–ª—é—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º

## –í–≤–µ–¥–µ–Ω–∏–µ

–í—Å–µ, –∫—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, —Ç–∞–∫ –∏–ª–∏ –∏–Ω–∞—á–µ —Ä–µ—à–∞—é—Ç –¥–ª—è —Å–µ–±—è –≤–æ–ø—Ä–æ—Å: –∫–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —É—á–∞—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤. –†–∞–∑—É–º–µ–µ—Ç—Å—è, –ª—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∞–∫–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏. –ù–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ.

–ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç –º–æ–Ω–æ–ª–∏—Ç–∞ –∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ø—Ä–∏–Ω–æ—Å–∏—Ç –≥–∏–±–∫–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å, –Ω–æ –∏ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. –û–¥–Ω–∞ –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º ‚Äì —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –í –º–æ–Ω–æ–ª–∏—Ç–µ –æ–±—ã—á–Ω–æ –º–æ–∂–Ω–æ –æ–±–µ—Ä–Ω—É—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π –æ–¥–Ω–æ–π ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π: –ª–∏–±–æ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ, –ª–∏–±–æ –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–ª–Ω—ã–π –æ—Ç–∫–∞—Ç. –í –º–∏—Ä–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ —Ç–∞–∫–æ–π –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–Ω–æ–º–µ–Ω, —É –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∏ –æ–±—â–∞—é—Ç—Å—è –æ–Ω–∏ —á–µ—Ä–µ–∑ —Å–µ—Ç—å. –ö–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤, –Ω–µ–ø—Ä–æ—Å—Ç–æ. –í–æ–∑–Ω–∏–∫–∞–µ—Ç —Ä–∏—Å–∫ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: –æ–¥–Ω–∞ —á–∞—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –∏–∑–º–µ–Ω–∏–ª–∞—Å—å, –∞ –¥—Ä—É–≥–∞—è ‚Äì –Ω–µ—Ç, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º (–Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–º) —Å–æ—Å—Ç–æ—è–Ω–∏—è–º –¥–∞–Ω–Ω—ã—Ö.

–í —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –º—ã –ø—Ä–æ—Å–ª–µ–¥–∏–º —ç–≤–æ–ª—é—Ü–∏—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤:

1. –ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è SAGA
2. –£–ª—É—á—à–µ–Ω–Ω–∞—è Event-Driven SAGA
3. –ü–µ—Ä–µ—Ö–æ–¥ –∫ CQRS
4. –í–≤–µ–¥–µ–Ω–∏–µ Event Sourcing
5. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ES+CQRS

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏–∫—É

–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Ç—Ä–µ–±—É—é—Ç –æ—Å–æ–±—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤. 
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —ç–≤–æ–ª—é—Ü–∏—é —Ä–µ—à–µ–Ω–∏—è –æ—Ç –±–∞–∑–æ–≤–æ–π SAGA –¥–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π Event-Driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

## SAGA

### –ü—Ä–æ–±–ª–µ–º–∞—Ç–∏–∫–∞

Saga ‚Äì —ç—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –¥–æ—Å—Ç–∏—á—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –ò–¥–µ—è —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Ä–∞–∑–±–∏—Ç—å –±–æ–ª—å—à—É—é –±–∏–∑–Ω–µ—Å-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—â—É—é –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤, –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –∫–∞–∂–¥–æ–º –∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤. –ö–∞–∂–¥—ã–π —à–∞–≥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ä–∞–º–∫–∞—Ö —Å–≤–æ–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∞—Ç–æ–º–∞—Ä–Ω–æ. –ï—Å–ª–∏ –≤—Å–µ —à–∞–≥–∏ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ ‚Äì –≤—Å—è —Å–∞–≥–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ–π. –ï—Å–ª–∏ –∂–µ –Ω–∞ –∫–∞–∫–æ–º-—Ç–æ —ç—Ç–∞–ø–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, –ø–∞—Ç—Ç–µ—Ä–Ω Saga –ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –æ—Ç–º–µ–Ω—ã —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å–∏—Å—Ç–µ–º—ã –≤ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

<img src="./static/diagrams/saga-overview.png" alt="saga_overview">

**–ö–∞–∂–¥–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è:**

1. –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –∞—Ç–æ–º–∞—Ä–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π —Å–ª—É–∂–±—ã.
2. –û–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å–ª—É–∂–±—ã.
3. –ò–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏–µ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ.

–ï—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π, —Å–∞–≥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä—è–¥ **–∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**, —á—Ç–æ–±—ã –æ—Ç–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –≤–Ω–µ—Å–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Saga: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å "–æ—Ç–∫–∞—Ç–æ–º"
–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –±—Ä–æ–Ω–∏—Ä—É–µ—Ç–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤:

1. –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–µ–ª—å
2. –ö—É–ø–∏—Ç—å –±–∏–ª–µ—Ç—ã –Ω–∞ —Å–∞–º–æ–ª–µ—Ç
3. –û–ø–ª–∞—Ç–∏—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∫—É

> **–ö–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (Compensable Transactions)** –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç–º–µ–Ω–µ–Ω—ã –∏–ª–∏ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—Ç—Å—è –¥—Ä—É–≥–∏–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ —Å –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–º —ç—Ñ—Ñ–µ–∫—Ç–æ–º. –ï—Å–ª–∏ —à–∞–≥ —Å–∞–≥–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π, –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—Ç–º–µ–Ω—è—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è, –≤–Ω–µ—Å–µ–Ω–Ω—ã–µ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏.
>
> –ö–æ–¥:
> ```go
> package main
> 
> func cancelHotelBooking(bookingID string) error {
>    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ–Ω—å–≥–∏ –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º –Ω–æ–º–µ—Ä
>    return hotelAPI.Cancel(bookingID)
> }
> ```

> **–¢–æ—á–∫–∞ –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞ (Pivot Transaction)**
> - –ü–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –æ—Ç–º–µ–Ω–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞
> - –ü—Ä–∏–º–µ—Ä: –í—ã–¥–∞—á–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ —Å–∞–º–æ–ª–µ—Ç
> - –í–∞–∂–Ω–æ: –í—Å–µ —à–∞–≥–∏ –î–û —ç—Ç–æ–π —Ç–æ—á–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º—ã–º–∏

> –ü–æ–≤—Ç–æ—Ä—è–µ–º—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (Retriable Transactions)
> - –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å–ª–µ —Ç–æ—á–∫–∏ –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞
> - –ü—Ä–∏–º–µ—Ä: –û—Ç–ø—Ä–∞–≤–∫–∞ –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ –ø–æ—á—Ç—É (–º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å)
> 
> –ö–æ–¥:
> ```go
> package main
> 
> func sendTickets(email string, tickets []Ticket) error {
>    // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π "–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ª–∏ —É–∂–µ?"
>    if !checkIfSent(email) {
>        return emailService.Send(email, tickets)
>    }
>    return nil
> }
> ```

**–ü—Ä–∏–º–µ—Ä –ø–æ—Ç–æ–∫–∞ Saga –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è:**

<img src="./static/diagrams/saga_booking.svg" alt="saga_booking">

1. **–ö–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º—ã–µ —à–∞–≥–∏:** –ë—Ä–æ–Ω—å –æ—Ç–µ–ª—è (–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å), –ü–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–æ–≤ (–º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å)
2. **–¢–æ—á–∫–∞ –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞:** –û–ø–ª–∞—Ç–∞ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ (–Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ —É—Å–ª–æ–≤–∏—è–º)
3. **–ü–æ–≤—Ç–æ—Ä—è–µ–º—ã–µ —à–∞–≥–∏:** –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ)

### –ü–æ–¥—Ö–æ–¥—ã –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Saga

–î–≤–∞ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∞–≥–∞ —è–≤–ª—è—é—Ç—Å—è **—Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏** –∏ **–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏**. –ö–∞–∂–¥—ã–π –ø–æ–¥—Ö–æ–¥ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –ø—Ä–æ–±–ª–µ–º –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.

####  –•–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—è

–í –ø–æ–¥—Ö–æ–¥–µ –∫ —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏ —Å–ª—É–∂–±—ã –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è —Å–æ–±—ã—Ç–∏—è–º–∏ –±–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏ –∫–∞–∂–¥–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –¥–æ–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –¥—Ä—É–≥–∏—Ö —Å–ª—É–∂–±–∞—Ö.

<img src="./static/diagrams/choreography-pattern.png" alt="saga_overview">

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**

```go
package main

// –°–µ—Ä–≤–∏—Å –∑–∞–∫–∞–∑–æ–≤ (–ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è)
type OrderService struct {
    eventBus EventBus
}

func (s *OrderService) CreateOrder(order Order) error {
    if err := validateOrder(order); err != nil {
        return err
    }

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–∫–∞–∑ –≤ –ë–î
    orderID, err := s.saveOrder(order)
    if err != nil {
        return err
    }

    // –ü—É–±–ª–∏–∫—É–µ–º —Å–æ–±—ã—Ç–∏–µ
    s.eventBus.Publish("order.created", OrderCreatedEvent{
        OrderID:    orderID,
        Items:      order.Items,
        CustomerID: order.CustomerID,
        Amount:     order.Amount,
    })
    
    return nil
}

// –°–µ—Ä–≤–∏—Å –æ–ø–ª–∞—Ç—ã (–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è)
type PaymentService struct {
    eventBus EventBus
}

func (s *PaymentService) Start() {
    s.eventBus.Subscribe("order.created", func(event OrderCreatedEvent) {
        paymentID, err := s.charge(event.CustomerID, event.Amount)
        if err != nil {
            s.eventBus.Publish("payment.failed", PaymentFailedEvent{
                OrderID: event.OrderID,
                Reason:  err.Error(),
            })
            return
        }
        
        s.eventBus.Publish("payment.success", PaymentSuccessEvent{
            OrderID:   event.OrderID,
            PaymentID: paymentID,
        })
    })

    // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è
    s.eventBus.Subscribe("inventory.reservation_failed", func(event ReservationFailedEvent) {
        s.refund(event.PaymentID)
    })
}

// –°–µ—Ä–≤–∏—Å –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏
type InventoryService struct {
    eventBus EventBus
}

func (s *InventoryService) Start() {
    s.eventBus.Subscribe("payment.success", func(event PaymentSuccessEvent) {
        err := s.reserveItems(event.OrderID)
        if err != nil {
            s.eventBus.Publish("inventory.reservation_failed", ReservationFailedEvent{
                OrderID:   event.OrderID,
                PaymentID: event.PaymentID,
                Reason:    err.Error(),
            })
            return
        }
        
        s.eventBus.Publish("inventory.reserved", InventoryReservedEvent{
            OrderID: event.OrderID,
        })
    })
}
```

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏                                                                 | –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏                                                                 |
|-----------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
| **‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –≤ –ø—Ä–æ—Å—Ç—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö**<br>–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è workflows —Å 2-3 —Å–µ—Ä–≤–∏—Å–∞–º–∏ –±–µ–∑ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏.<br>–ü—Ä–∏–º–µ—Ä: –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ‚Üí –°–ø–∏—Å–∞–Ω–∏–µ ‚Üí –î–æ—Å—Ç–∞–≤–∫–∞ | **‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è**<br>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —à–∞–≥–æ–≤ –¥–µ–ª–∞–µ—Ç workflow –∑–∞–ø—É—Ç–∞–Ω–Ω—ã–º.<br>–ü—Ä–∏–º–µ—Ä: –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω—É–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã |
| **üîÑ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏–∏**<br>–ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.<br>–ü—Ä–∏–º–µ—Ä: –°–µ—Ä–≤–∏—Å –æ–ø–ª–∞—Ç—ã –Ω–∞–ø—Ä—è–º—É—é –≤—ã–∑—ã–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ | **üîÑ –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**<br>–°–µ—Ä–≤–∏—Å—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Å–∏–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏.<br>–ü—Ä–∏–º–µ—Ä: –°–µ—Ä–≤–∏—Å A –≤—ã–∑—ã–≤–∞–µ—Ç B, B –≤—ã–∑—ã–≤–∞–µ—Ç C, –∞ C —Å–Ω–æ–≤–∞ –≤—ã–∑—ã–≤–∞–µ—Ç A |
| **‚ö° –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –æ—Ç–∫–∞–∑–∞–º**<br>–ù–µ—Ç –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞.<br>–ü—Ä–∏–º–µ—Ä: –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —É–ø–∞–ª, —ç—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π workflow | **üêõ –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**<br>–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–Ω–∏–º–∞—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è —ç–Ω–¥-—Ç—É-—ç–Ω–¥ —Ç–µ—Å—Ç–æ–≤.<br>–ü—Ä–∏–º–µ—Ä: –î–ª—è —Ç–µ—Å—Ç–∞ —Ü–µ–ø–æ—á–∫–∏ –∏–∑ 5 —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω—É–∂–Ω—ã –≤—Å–µ 5 –≤ —Ä–∞–±–æ—á–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ |
| **üìä –ì–∏–±–∫–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π**<br>–û—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å —Å–≤–æ—é –ª–æ–≥–∏–∫—É –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.<br>–ü—Ä–∏–º–µ—Ä: –°–µ—Ä–≤–∏—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å—Å—è –±–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞ –æ–ø–ª–∞—Ç—ã | **üîç –ü—Ä–æ–±–ª–µ–º—ã –æ—Ç–ª–∞–¥–∫–∏**<br>–¢—Ä—É–¥–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.<br>–ü—Ä–∏–º–µ—Ä: –ü—Ä–∏ –æ—à–∏–±–∫–µ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ —Ü–µ–ø–æ—á–∫–µ |

**–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:**

- –í—ã–±–∏—Ä–∞–π—Ç–µ —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—é –¥–ª—è:
- –ü—Ä–æ—Å—Ç—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (‚â§3 —Å–µ—Ä–≤–∏—Å–æ–≤)
- –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤
- –í –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö

**–ò–∑–±–µ–≥–∞–π—Ç–µ —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏ –ø—Ä–∏:**

- –°–ª–æ–∂–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞—Ö
- –ß–∞—Å—Ç—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö workflow
- –ñ–µ—Å—Ç–∫–∏—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –∫ –∞—É–¥–∏—Ç—É

#### –û—Ä–∫–µ—Å—Ç—Ä–æ–≤–∫–∞

–í –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∏–ª–∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ —Å–æ–æ–±—â–∞–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–∞–º, –∫–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–±—ã—Ç–∏–π. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã saga, —Ö—Ä–∞–Ω–∏—Ç –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–±–æ–µ–≤ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

<img src="./static/diagrams/orchestrator.png" alt="saga_overview">

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ (—Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–æ–º):**

```go
package main

// OrderOrchestrator —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
type OrderOrchestrator struct {
    paymentService   *PaymentService
    inventoryService *InventoryService
    shippingService *ShippingService
}

// ProcessOrder –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å—é —Ü–µ–ø–æ—á–∫—É —à–∞–≥–æ–≤
func (o *OrderOrchestrator) ProcessOrder(order Order) error {
    // –®–∞–≥ 1: –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
    if err := o.inventoryService.ReserveItems(order.Items); err != nil {
        return fmt.Errorf("reservation failed: %w", err)
    }

    // –®–∞–≥ 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞
    paymentID, err := o.paymentService.Charge(order.CustomerID, order.Amount)
    if err != nil {
        // –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è: –û—Ç–º–µ–Ω–∞ —Ä–µ–∑–µ—Ä–≤–∞
        if rollbackErr := o.inventoryService.CancelReservation(order.Items); rollbackErr != nil {
            return fmt.Errorf("payment failed AND rollback failed: %v (original: %w)", rollbackErr, err)
        }
        return fmt.Errorf("payment failed: %w", err)
    }

    // –®–∞–≥ 3: –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏
    if err := o.shippingService.ScheduleDelivery(order); err != nil {
        // –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è: –í–æ–∑–≤—Ä–∞—Ç –ø–ª–∞—Ç–µ–∂–∞ + –æ—Ç–º–µ–Ω–∞ —Ä–µ–∑–µ—Ä–≤–∞
        _, refundErr := o.paymentService.Refund(paymentID)
        rollbackErr := o.inventoryService.CancelReservation(order.Items)
        
        if refundErr != nil || rollbackErr != nil {
            return fmt.Errorf("shipping failed AND rollback problems (refund: %v, inventory: %v) (original: %w)", 
                refundErr, rollbackErr, err)
        }
        return fmt.Errorf("shipping failed: %w", err)
    }

    return nil
}
```

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏                                                                 | –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏                                                                 |
|-----------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
| **üß† –ö–æ–Ω—Ç—Ä–æ–ª—å —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤**<br>–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Ü–µ–ø–æ—á–µ–∫ –∏–∑ 5+ —Å–µ—Ä–≤–∏—Å–æ–≤.<br>*–ü—Ä–∏–º–µ—Ä: –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è (–æ—Ç–µ–ª—å + –∞–≤–∏–∞ + —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ + —ç–∫—Å–∫—É—Ä—Å–∏–∏)* | **üõ† –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**<br>–¢—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–æ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π.<br>*–ü—Ä–∏–º–µ—Ä: –ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è e-commerce –Ω–∞ 10+ —à–∞–≥–æ–≤* |
| **üîÑ –ù–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**<br>–°–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.<br>*–ü—Ä–∏–º–µ—Ä: –ü–ª–∞—Ç–µ–∂–Ω—ã–π —Å–µ—Ä–≤–∏—Å –Ω–µ –∑–Ω–∞–µ—Ç –æ —Å–µ—Ä–≤–∏—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏* | **‚ö† –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –æ—Ç–∫–∞–∑–∞**<br>–ü–∞–¥–µ–Ω–∏–µ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã.<br>*–ü—Ä–∏–º–µ—Ä: –ü—Ä–∏ —Å–±–æ–µ –≤ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–µ –∑–∞–∫–∞–∑—ã –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è* |
| **üìù –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**<br>–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.<br>*–ü—Ä–∏–º–µ—Ä: –í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –æ—Ç–º–µ–Ω—ã –∑–∞–∫–∞–∑–∞ –≤ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–µ* | **üìâ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**<br>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–≤–µ–Ω–æ –≤ —Ü–µ–ø–æ—á–∫–µ –≤—ã–∑–æ–≤–æ–≤.<br>*–ü—Ä–∏–º–µ—Ä: –ó–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ 1000+ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤* |
| **üêû –ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏**<br>–í–µ—Å—å workflow –≤–∏–¥–µ–Ω –≤ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ.<br>*–ü—Ä–∏–º–µ—Ä: –õ–æ–≥–∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∑–∞–∫–∞–∑–∞* | **üîß –í—ã—Å–æ–∫–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å**<br>–ò–∑–º–µ–Ω–µ–Ω–∏—è workflow —Ç—Ä–µ–±—É—é—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.<br>*–ü—Ä–∏–º–µ—Ä: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —à–∞–≥–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞* |

**–ö–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—Ç—å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é:**

- –î–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (>4 —à–∞–≥–æ–≤)
- –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
- –í —Å–∏—Å—Ç–µ–º–∞—Ö —Å –∂–µ—Å—Ç–∫–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ –∞—É–¥–∏—Ç—É

#### –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è vs —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—è —Å–∞–≥–∏. –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è:

**–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è:**

–£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äì –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∞–≥–∏. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–Ω–∞–µ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π —Ü–µ–ª–∏–∫–æ–º –∏ –ø–æ —à–∞–≥–∞–º —Ä–∞—Å—Å—ã–ª–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã —Å–µ—Ä–≤–∏—Å–∞–º: —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ. –û–Ω –≤—ã–∑—ã–≤–∞–µ—Ç Service A, –∑–∞—Ç–µ–º Service B, –∏ —Ç.–¥., –∏ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ —Ç–∞–∫–∂–µ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è. –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —É–ø—Ä–æ—â–∞–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–≤—Å—è –ª–æ–≥–∏–∫–∞ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ), –Ω–æ –≤–≤–æ–¥–∏—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏ —Ç–æ—á–∫—É –∫–æ–Ω—Ç—Ä–æ–ª—è.

- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–º
- –Ø–≤–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤
- –ü—Ä–æ—â–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:** –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö —Ç—É—Ä–æ–≤

**–•–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—è:**

–ó–¥–µ—Å—å –Ω–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è ‚Äì –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å —Å–∞–º —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∏ —Ä–µ—à–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ. –¢–æ –µ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –æ–±–º–µ–Ω–µ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏: –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —à–∞–≥–∞ –æ–¥–Ω–∏–º —Å–µ—Ä–≤–∏—Å–æ–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã, –∑–∞–ø—É—Å–∫–∞—é—â–∏–µ —Å–≤–æ–∏ —à–∞–≥–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, Order Service –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ OrderCreated; Payment Service, –ø–æ–ª—É—á–∏–≤ –µ–≥–æ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–ª–∞—Ç–µ–∂ –∏ –ø—É–±–ª–∏–∫—É–µ—Ç –ª–∏–±–æ PaymentApproved, –ª–∏–±–æ PaymentFailed; Order Service —Å–ª—É—à–∞–µ—Ç —ç—Ç–∏ —Å–æ–±—ã—Ç–∏—è –∏ —Ä–µ—à–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—Ç—å –∏–ª–∏ –æ—Ç–º–µ–Ω—è—Ç—å –∑–∞–∫–∞–∑. –•–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—è –∏—Å–∫–ª—é—á–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä ‚Äì —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –∏ –±–æ–ª–µ–µ –≥–∏–±–∫–∞—è, –Ω–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π ‚Äú—Ä–∞–∑–º–∞–∑–∞–Ω–∞‚Äù –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º, —á—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫—É.

- –°–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è
- –ù–µ—Ç –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞
- –í—ã—à–µ –≥–∏–±–∫–æ—Å—Ç—å, –Ω–æ —Å–ª–æ–∂–Ω–µ–µ –æ—Ç–ª–∞–¥–∫–∞

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:** –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–æ–≤ e-commerce

–û–±–∞ –ø–æ–¥—Ö–æ–¥–∞ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è. –í –ø—Ä–æ—Å—Ç—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —á–∞—Å—Ç–æ —Ö–≤–∞—Ç–∞–µ—Ç —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏ (—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥), –Ω–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —É—Å–ª–æ–≤–∏–π –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–æ–±–Ω–µ–µ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è (—è–≤–Ω–æ–µ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è).

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Saga

–ü–∞—Ç—Ç–µ—Ä–Ω Saga —Å—Ç–∞–ª –ø–æ–ø—É–ª—è—Ä–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å–∏–ª—å–Ω—ã–º —Å—Ç–æ—Ä–æ–Ω–∞–º:

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö ACID:** –°–∞–≥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ –¥–≤—É—Ö—Ñ–∞–∑–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ –∏ –¥—Ä—É–≥–∏—Ö —Ç—è–∂—ë–ª—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤. –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å–≤–æ–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ. –î–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è/–∫–æ–º–∞–Ω–¥—ã, –∞ –Ω–µ —á–µ—Ä–µ–∑ –æ–±—â–∏–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä.
- **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —á–∞—Å—Ç–∏—á–Ω—ã–º —Å–±–æ—è–º:** –ï—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å, Saga –º–æ–∂–µ—Ç –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è. –°–∏—Å—Ç–µ–º–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞. –≠—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (–∫–∞–∂–¥—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π —à–∞–≥ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ).
- **–ì–∏–±–∫–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏:** –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–æ—á–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π ‚Äì —ç—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å –ª—é–±—ã–µ –º–µ—Ä—ã, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏–µ –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å –ø–ª–∞—Ç—ë–∂ –Ω–µ–ª—å–∑—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –º–æ–∂–Ω–æ –ø–æ–º–µ—Ç–∏—Ç—å –∑–∞–∫–∞–∑ –∫–∞–∫ —Ç—Ä–µ–±—É—é—â–∏–π —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞. –¢–∞–∫–∞—è –±–∏–∑–Ω–µ—Å-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–∏ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–º ACID-–æ—Ç–∫–∞—Ç–µ.
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –°–µ—Ä–≤–∏—Å—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º —Ä–∞–±–æ—Ç–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏ –Ω–µ –∂–¥–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞, –µ—Å–ª–∏ –ª–æ–≥–∏–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç. –ù–µ—Ç —É–¥–µ—Ä–∂–∞–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ ‚Äì –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã. –í –±–æ–ª—å—à–∏—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö Saga –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –ª—É—á—à–µ, —á–µ–º —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä.

### –°–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏ Saga

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø–ª—é—Å—ã, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Saga –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ä—è–¥—É —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π, –æ –∫–æ—Ç–æ—Ä—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞–º –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å:

- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∞—è –ª–æ–≥–∏–∫–∞:** –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–æ–ª–∂–Ω—ã —è–≤–Ω–æ –ø—Ä–æ–¥—É–º—ã–≤–∞—Ç—å –∏ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞. –≠—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–∞–±–æ—Ç—ã –∏ —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ –ø–æ–Ω—è—Ç—å –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å: —á—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —à–∞–≥ X —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω, –∞ —à–∞–≥ Y –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è? –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–∫–∏—Ö –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–π –ø–æ—Ä–æ–π –Ω–µ–ø—Ä–æ—Å—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–æ—Ç–º–µ–Ω–∏—Ç—å –ø–ª–∞—Ç–µ–∂¬ª ‚Äì –Ω–µ—Ç—Ä–∏–≤–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞, –µ—Å–ª–∏ –¥–µ–Ω—å–≥–∏ —É–∂–µ —Å–ø–∏—Å–∞–Ω—ã).
- **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏, –∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –±—ã–ª–∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã, —Ç–æ –µ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ –∏–∑–º–µ–Ω—è–ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–µ—Ä—Ö –ø–µ—Ä–≤–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞. –ü—Ä–∏—á–∏–Ω–∞ ‚Äì –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å—Ä–µ–¥–µ –Ω–µ–∏–∑–±–µ–∂–Ω—ã —Ä–µ—Ç—Ä–∞–∏ –∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç —Å–ª—É—á–∞–π–Ω–æ –¥–≤–∞–∂–¥—ã –ø–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é –ø–æ—Å–ª–µ —Å–±–æ—è. –ï—Å–ª–∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–æ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞) –≤—ã–∑–≤–∞—Ç—å –¥–≤–∞–∂–¥—ã, –Ω–∞ –≤—ã—Ö–æ–¥–µ —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ (–≤—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ –Ω–µ –¥–æ–ª–∂–µ–Ω –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ —á—Ç–æ-—Ç–æ –∏—Å–ø–æ—Ä—Ç–∏—Ç—å). –î–ª—è —ç—Ç–æ–≥–æ —á–∞—Å—Ç–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º: –µ—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Ä–∞–Ω–µ–µ, –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–µ –¥–µ–ª–∞—Ç—å. –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —É—Å–ª–æ–∂–Ω—è–µ—Ç –∫–æ–¥, –Ω–æ –±–µ–∑ –Ω–µ—ë Saga –Ω–µ–Ω–∞–¥—ë–∂–Ω–∞.
- **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –Ω–µ–ø–æ–ª–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å:** –ü–æ–∫–∞ —Å–∞–≥–∞ –Ω–µ –∑–∞–∫–æ–Ω—á–µ–Ω–∞ (–∏–ª–∏ –Ω–µ –æ—Ç–∫–∞—Ç–∏–ª–∞—Å—å –ø—Ä–∏ –æ—à–∏–±–∫–µ), —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –∫–æ–≥–¥–∞ —á–∞—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤ —É–∂–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∞ –¥—Ä—É–≥–∏–µ ‚Äì –µ—â—ë –Ω–µ—Ç. –≠—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ Eventually Consistent ‚Äì ¬´–≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å—á—ë—Ç–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ¬ª. –ù—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ, —á—Ç–æ –º–µ–∂–¥—É —à–∞–≥–∞–º–∏ —Å–∞–≥–∏ –¥–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã. –ù–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–∫–∞–∑ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω, –Ω–æ –æ–ø–ª–∞—Ç–∞ –µ—â—ë –Ω–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ ‚Äì –¥—Ä—É–≥–∏–º —Å–µ—Ä–≤–∏—Å–∞–º –Ω–µ–ª—å–∑—è —Å—á–∏—Ç–∞—Ç—å –µ–≥–æ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–º. –û–±—ã—á–Ω–æ —Ä–µ—à–∞—é—Ç —á–µ—Ä–µ–∑ —Å—Ç–∞—Ç—É—Å—ã (pending, in progress, etc.) –∏ —Å–∫—Ä—ã—Ç–∏–µ ¬´–ø–æ–ª—É–ø—Ä–æ–≤–µ–¥—ë–Ω–Ω—ã—Ö¬ª –æ–ø–µ—Ä–∞—Ü–∏–π –æ—Ç –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ–∫–∞ —Å–∞–≥–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è.
- **–û—Ç–ª–∞–¥–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å–∞–≥–µ, —Å–ª–æ–∂–Ω–µ–µ, —á–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –õ–æ–≥–∏–∫–∞ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–∞ –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º (–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏), –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ –≤–∏–¥–Ω–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–Ω–µ–¥—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–∞–≥–∏, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–π –≤–æ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è), –≤–µ—Å—Ç–∏ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç—Ä–µ–π—Å–∏–Ω–≥-—Å–∏—Å—Ç–µ–º—ã. –¢–æ–ª—å–∫–æ —Ç–∞–∫ –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å —Ü–µ–ø–æ—á–∫—É –¥–µ–π—Å—Ç–≤–∏–π –∏ –≤—ã—è–≤–∏—Ç—å, –≥–¥–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞.
- **–î–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∞–≥–∏:** –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä, –≤–∞–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–∞–≥–∏ –≤ –Ω–∞–¥—ë–∂–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –í —Å–ª—É—á–∞–µ —Å–±–æ—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –æ–Ω –¥–æ–ª–∂–µ–Ω –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–∞–≥—É (–∏–ª–∏ –æ—Ç–∫–∞—Ç–∏—Ç—å –µ—ë). –≠—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –≤ –ë–î –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏. –ü—Ä–∏ —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏ –¥–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è –±—Ä–æ–∫–µ—Ä–æ–º —Å–æ–æ–±—â–µ–Ω–∏–π (—Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è) –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.
- **–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Ç—Ä–æ–≥–æ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:** Saga —Ö–æ—Ä–æ—à–∞ –¥–ª—è –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –≥–¥–µ –¥–æ–ø—É—Å—Ç–∏–º–∞ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å. –ï—Å–ª–∏ –∂–µ –Ω—É–∂–Ω–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–≤–æ–¥ –¥–µ–Ω–µ–≥ –º–µ–∂–¥—É —Å—á–µ—Ç–∞–º–∏ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –∫–æ–ø–µ–µ–∫), —Å–∞–≥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω–æ–π –∏–ª–∏ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ–π ‚Äì –ª—É—á—à–µ –ø–æ–∏—Å–∫–∞—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã (–æ–± —ç—Ç–æ–º –¥–∞–ª–µ–µ).

## –î–≤—É—Ö—Ñ–∞–∑–Ω—ã–π –∫–æ–º–º–∏—Ç (Two-Phase Commit, 2PC)

–í –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç—å Saga, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ø—Ä–æ—Ç–æ–∫–æ–ª **–¥–≤—É—Ö—Ñ–∞–∑–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ (2PC)** —Å—Ç—Ä–µ–º–∏—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–µ–º–∞–Ω—Ç–∏–∫—É –µ–¥–∏–Ω–æ–π –∞—Ç–æ–º–∞—Ä–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–∞–∂–µ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ. 2PC ‚Äì —ç—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —É–∑–ª–∞–º–∏ (–±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–µ—Ä–≤–∏—Å–∞–º–∏) —Å –ø–æ–º–æ—â—å—é —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞. –ï–≥–æ —Ü–µ–ª—å ‚Äì –¥–æ–±–∏—Ç—å—Å—è, —á—Ç–æ–±—ã –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ª–∏–±–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –ª–∏–±–æ –æ—Ç–º–µ–Ω–∏–ª–∏, –∏ –Ω–∏ –æ–¥–∏–Ω –Ω–µ –æ—Å—Ç–∞–ª—Å—è ‚Äú–≤ —Å—Ç–æ—Ä–æ–Ω–µ‚Äù.

<img src="./static/diagrams/p2c.png" alt="p2c_overview">

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã 2PC

–ö–∞–∫ —Å–ª–µ–¥—É–µ—Ç –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è, –ø—Ä–æ—Ç–æ–∫–æ–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ **–¥–≤–µ —Ñ–∞–∑—ã**. –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞ –∏–ª–∏ –¥–≤–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö), –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∞—Ç–æ–º–∞—Ä–Ω–æ —Å–µ—Ä–∏—é –æ–ø–µ—Ä–∞—Ü–∏–π. –î–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äì **–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**. –ê–ª–≥–æ—Ä–∏—Ç–º —Ç–∞–∫–æ–π:

1. **–§–∞–∑–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ (prepare phase, —Ñ–∞–∑–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è):** –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ä–∞—Å—Å—ã–ª–∞–µ—Ç –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫ –∫–æ–º–º–∏—Ç—É. –ö–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –ª–æ–∫–∞–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–µ–ª–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–≤–æ–µ–π –ë–î) –Ω–æ –Ω–µ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∏—Ö, –∞ –ø–æ–º–µ—á–∞–µ—Ç –∫–∞–∫ ‚Äú–≥–æ—Ç–æ–≤—ã–µ –∫ –∫–æ–º–º–∏—Ç—É‚Äù (–≤ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö —ç—Ç–æ –æ–±—ã—á–Ω–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∑–∞–ø–∏—Å–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∂—É—Ä–Ω–∞–ª –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã). –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫ –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—É –ª–∏–±–æ ‚Äú–≥–æ—Ç–æ–≤‚Äù (Yes), –µ—Å–ª–∏ –µ–≥–æ —ç—Ç–∞–ø –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ –∏ –æ–Ω –≥–æ—Ç–æ–≤ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å, –ª–∏–±–æ ‚Äú–Ω–µ –º–æ–≥—É‚Äù (No), –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –∏ –æ–Ω –Ω–µ —Å–º–æ–∂–µ—Ç –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å. –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø–æ —Å—É—Ç–∏ –≥–æ–ª–æ—Å—É—é—Ç ‚Äú–∑–∞‚Äù –∏–ª–∏ ‚Äú–ø—Ä–æ—Ç–∏–≤‚Äù –æ–±—â–µ–π —Ñ–∏–∫—Å–∞—Ü–∏–∏.
2. **–§–∞–∑–∞ —Ñ–∏–∫—Å–∞—Ü–∏–∏ (commit phase):** –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Å–æ–±–∏—Ä–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã. –ï—Å–ª–∏ –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Ç–≤–µ—Ç–∏–ª–∏ "–≥–æ—Ç–æ–≤/Yes", —Ç–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –ø–æ—Å—ã–ª–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É Commit –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º. –ö–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ–∏–∫—Å–∞—Ü–∏—é —Å–≤–æ–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π (–æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏—Ö –≤ —Å–≤–æ–µ–π —Å–∏—Å—Ç–µ–º–µ). –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —É—á–∞—Å—Ç–Ω–∏–∫ –æ—Ç–≤–µ—Ç–∏–ª –æ—Ç–∫–∞–∑–æ–º ("No"), –ª–∏–±–æ –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –∏–∑-–∑–∞ —Å–±–æ—è, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –ø–æ—Å—ã–ª–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É Rollback –≤—Å–µ–º —Ç–µ–º, –∫—Ç–æ –±—ã–ª –≥–æ—Ç–æ–≤. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Ç–º–µ–Ω—è—Ç —Å–≤–æ–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∏–ª–∏ –Ω–µ –±—É–¥—É—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å). –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å: –ª–∏–±–æ –≤—Å–µ commit, –ª–∏–±–æ –≤—Å–µ rollback.

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–π —Ñ–∞–∑—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–æ–±—â–∏—Ç—å –∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é, –Ω–∞—á–∞–≤—à–µ–º—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é), —á—Ç–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –∏–ª–∏ –æ—Ç–∫–∞—Ç–∏–ª–∞—Å—å.

**–ü—Ä–∏–º–µ—Ä –Ω–∞ –ø—Å–µ–≤–¥–æ–∫–æ–¥–µ:** –ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–∞ —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞ –∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ 2PC –¥–ª—è –¥–≤—É—Ö —É—Å–ª–æ–≤–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤:

```go
package main

import (
	"errors"
	"fmt"
	"sync"
)

// TransactionCoordinator —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–≤—É—Ö—Ñ–∞–∑–Ω—ã–º –∫–æ–º–º–∏—Ç–æ–º
type TransactionCoordinator struct {
	participants []Participant
	mu           sync.Mutex
}

// AddParticipant –¥–æ–±–∞–≤–ª—è–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
func (tc *TransactionCoordinator) AddParticipant(p Participant) {
	tc.mu.Lock()
	defer tc.mu.Unlock()
	tc.participants = append(tc.participants, p)
}

// PrepareAll —Ñ–∞–∑–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ (—Ñ–∞–∑–∞ 1)
func (tc *TransactionCoordinator) PrepareAll() (bool, error) {
	tc.mu.Lock()
	defer tc.mu.Unlock()

	var wg sync.WaitGroup
	results := make(chan error, len(tc.participants))

	for _, p := range tc.participants {
		wg.Add(1)
		go func(p Participant) {
			defer wg.Done()
			if err := p.Prepare(); err != nil {
				results <- fmt.Errorf("%s: %v", p.Name(), err)
				return
			}
			results <- nil
		}(p)
	}

	go func() {
		wg.Wait()
		close(results)
	}()

	var hasErrors bool
	for err := range results {
		if err != nil {
			fmt.Printf("Prepare error: %v\n", err)
			hasErrors = true
		}
	}

	return !hasErrors, nil
}

// CommitAll —Ñ–∞–∑–∞ –∫–æ–º–º–∏—Ç–∞ (—Ñ–∞–∑–∞ 2)
func (tc *TransactionCoordinator) CommitAll() error {
	tc.mu.Lock()
	defer tc.mu.Unlock()

	var wg sync.WaitGroup
	errChan := make(chan error, len(tc.participants))

	for _, p := range tc.participants {
		wg.Add(1)
		go func(p Participant) {
			defer wg.Done()
			if err := p.Commit(); err != nil {
				errChan <- fmt.Errorf("%s commit failed: %v", p.Name(), err)
				return
			}
			errChan <- nil
		}(p)
	}

	go func() {
		wg.Wait()
		close(errChan)
	}()

	for err := range errChan {
		if err != nil {
			return fmt.Errorf("commit failed: %v", err)
		}
	}

	return nil
}

// RollbackAll –æ—Ç–∫–∞—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
func (tc *TransactionCoordinator) RollbackAll() error {
	tc.mu.Lock()
	defer tc.mu.Unlock()

	var wg sync.WaitGroup
	errChan := make(chan error, len(tc.participants))

	for _, p := range tc.participants {
		wg.Add(1)
		go func(p Participant) {
			defer wg.Done()
			if err := p.Rollback(); err != nil {
				errChan <- fmt.Errorf("%s rollback failed: %v", p.Name(), err)
				return
			}
			errChan <- nil
		}(p)
	}

	go func() {
		wg.Wait()
		close(errChan)
	}()

	for err := range errChan {
		if err != nil {
			return fmt.Errorf("rollback failed: %v", err)
		}
	}

	return nil
}

// Participant –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
type Participant interface {
	Name() string
	Prepare() error
	Commit() error
	Rollback() error
}

// DatabaseParticipant —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞ (–ë–î)
type DatabaseParticipant struct {
	name     string
	prepared bool
}

func NewDatabaseParticipant(name string) *DatabaseParticipant {
	return &DatabaseParticipant{name: name}
}

func (d *DatabaseParticipant) Name() string {
	return d.name
}

func (d *DatabaseParticipant) Prepare() error {
	fmt.Printf("%s: preparing transaction...\n", d.name)
	// –ó–¥–µ—Å—å —Ä–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏:
	// - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
	// - –∑–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
	// - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
	
	// –î–ª—è –ø—Ä–∏–º–µ—Ä–∞ –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Å–µ–≥–¥–∞ —É—Å–ø–µ—à–Ω–∞
	d.prepared = true
	return nil
}

func (d *DatabaseParticipant) Commit() error {
	if !d.prepared {
		return errors.New("not prepared")
	}
	fmt.Printf("%s: committing transaction\n", d.name)
	// –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–æ–º–º–∏—Ç–∞
	d.prepared = false
	return nil
}

func (d *DatabaseParticipant) Rollback() error {
	fmt.Printf("%s: rolling back transaction\n", d.name)
	// –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç–∫–∞—Ç–∞
	d.prepared = false
	return nil
}

func main() {
	coord := TransactionCoordinator{}
	coord.AddParticipant(NewDatabaseParticipant("Database1"))
	coord.AddParticipant(NewDatabaseParticipant("Database2"))
	coord.AddParticipant(NewDatabaseParticipant("PaymentService"))

	// –§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
	ready, err := coord.PrepareAll()
	if err != nil {
		fmt.Printf("Prepare error: %v\n", err)
		return
	}

	if ready {
		// –§–∞–∑–∞ 2: –ö–æ–º–º–∏—Ç
		if err := coord.CommitAll(); err != nil {
			fmt.Printf("Commit failed: %v\n", err)
			// –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
		} else {
			fmt.Println("Transaction committed successfully")
		}
	} else {
		// –û—Ç–∫–∞—Ç
		if err := coord.RollbackAll(); err != nil {
			fmt.Printf("Rollback failed: %v\n", err)
		} else {
			fmt.Println("Transaction rolled back")
		}
	}
}
```

<img src="./static/diagrams/p2c_sample.svg" alt="p2c_sample">

–ï—Å–ª–∏ –±—ã –≤—Ç–æ—Ä–æ–π —É—á–∞—Å—Ç–Ω–∏–∫ –≤–µ—Ä–Ω—É–ª false –Ω–∞ —ç—Ç–∞–ø–µ prepare, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –≤—ã–∑–≤–∞–ª –±—ã rollbackAll(), –∏ —É—á–∞—Å—Ç–Ω–∏–∫(–∏) –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –±—ã –æ—Ç–∫–∞—Ç.

–í —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Ä–æ–ª—å Participant –≤—ã–ø–æ–ª–Ω—è—é—Ç –º–µ–Ω–µ–¥–∂–µ—Ä—ã —Ä–µ—Å—É—Ä—Å–æ–≤ ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–º–µ–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å prepare –∑–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∂—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å, –∞ –Ω–∞ commit ‚Äì –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –æ–±—ã—á–Ω–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ –≤–∏–¥–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (Transaction Manager) ‚Äì –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ —Å—Ä–µ–¥—É –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è.

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –¥–≤—É—Ö—Ñ–∞–∑–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞

–•–æ—Ç—è 2PC –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–≥—É—é —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –æ–Ω –∏–º–µ–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:

- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ù–∞ —Ñ–∞–∑–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –æ–±—ã—á–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω—è–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç—Ä–æ–∫–∏ –≤ –±–∞–∑–µ) –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã commit –∏–ª–∏ rollback. –ï—Å–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –º–Ω–æ–≥–æ, –∏ –æ–Ω–∏ –∂–¥—É—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞, —ç—Ç–æ –º–æ–∂–µ—Ç –∑–∞—Ç–æ—Ä–º–æ–∑–∏—Ç—å —Å–∏—Å—Ç–µ–º—É. –í —Å–ª—É—á–∞–µ –∑–∞–¥–µ—Ä–∂–µ–∫ –∏–ª–∏ —Å–±–æ–µ–≤ –æ–∂–∏–¥–∞–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω—ã–º, –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥—Ä—É–≥–∏–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º ‚Äì —Å–Ω–∏–∂–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º. 2PC –ø–æ—ç—Ç–æ–º—É –ø–ª–æ—Ö–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å —Ä–æ—Å—Ç–æ–º —á–∏—Å–ª–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: –∑–∞–¥–µ—Ä–∂–∫–∞ –æ–¥–Ω–æ–≥–æ —É–∑–ª–∞ —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ—Ö.
- **–¢–æ—á–∫–∞ –æ—Ç–∫–∞–∑–∞ ‚Äì –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä:** –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ ‚Äì —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π ‚Äú–∫–æ–º–∞–Ω–¥–∏—Ä‚Äù. –ï—Å–ª–∏ –æ–Ω –≤—ã–π–¥–µ—Ç –∏–∑ —Å—Ç—Ä–æ—è –≤ –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–æ–º–µ–Ω—Ç, —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –≤ –ø–æ–¥–≤–µ—à–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏—Å—å –∏ –æ—Ç–≤–µ—Ç–∏–ª–∏ ‚ÄúYes‚Äù, –∂–¥—É—Ç –∫–æ–º–∞–Ω–¥—É, –∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —É–º–µ—Ä –∏–ª–∏ –ø–æ—Ç–µ—Ä—è–ª —Å–≤—è–∑—å ‚Äì –æ–Ω–∏ –Ω–µ –∑–Ω–∞—é—Ç, –∫–æ–º–º–∏—Ç–∏—Ç—å –∏–º –∏–ª–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞—Ç—å. –¢–∞–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π (blocking) –≤ 2PC. –í –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–∏ –≤ –æ–∂–∏–¥–∞–Ω–∏–∏ —Ä–µ—à–µ–Ω–∏—è –º–æ–≥—É—Ç –¥–µ—Ä–∂–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –æ—Ç–∫—Ä—ã—Ç–æ–π –æ—á–µ–Ω—å –¥–æ–ª–≥–æ. –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞, —á—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —Å—É–¥—å–±—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –°—É—â–µ—Å—Ç–≤—É—é—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–ø—Ä–æ—Ç–æ–∫–æ–ª —Ç—Ä–µ—Ö—Ñ–∞–∑–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞, 3PC) –¥–ª—è —Å–º—è–≥—á–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã, –Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞ 2PC –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.
- **–û–≤–µ—Ä—Ö–µ–¥ –Ω–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é:** 2PC —Ç—Ä–µ–±—É–µ—Ç –¥–≤–∞ —Ä–∞—É–Ω–¥–∞ —Å–µ—Ç–µ–≤–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (broadcast prepare, –∑–∞—Ç–µ–º broadcast commit/rollback). –í —É—Å–ª–æ–≤–∏—è—Ö –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫ —ç—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –æ–≤–µ—Ä—Ö–µ–¥ –∫ –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. Saga –∂–µ, –Ω–∞–ø—Ä–æ—Ç–∏–≤, —á–∞—â–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –∏ —à–∞–≥–∏ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.
- **–°–ª–∞–±–∞—è –ø—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω–Ω–æ—Å—Ç—å –∫ –æ—Ç–∫–∞–∑–∞–º —Å–≤—è–∑–∏:** –ï—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –Ω–µ –ø–æ–ª—É—á–∏—Ç –æ—Ç –Ω–µ–≥–æ ‚Äú–≥–æ—Ç–æ–≤‚Äù, –∏ –≤—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è (—Ä–∞–¥–∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∂–µ—Ä—Ç–≤—É–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é). –í –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö, –≥–¥–µ –æ—Ç–∫–∞–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ —Ä–µ–¥–∫–æ—Å—Ç—å, 2PC –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–æ–ª–µ–µ —á–∞—Å—Ç—ã–º –æ—Ç–∫–∞–∑–∞–º –≤—Å–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å Saga, –∫–æ—Ç–æ—Ä–∞—è –º–æ–≥–ª–∞ –±—ã –¥–æ–∂–¥–∞—Ç—å—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞ –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å (–∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏).
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö:** –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ 2PC –º–µ–∂–¥—É –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –∏–¥—ë—Ç –≤—Ä–∞–∑—Ä–µ–∑ —Å —Ñ–∏–ª–æ—Å–æ—Ñ–∏–µ–π —Å–ª–∞–±–æ–π —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏. –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å ‚Äú–ø–æ–¥—á–∏–Ω–µ–Ω—ã‚Äù –æ–±—â–µ–º—É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—É –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª—É. –≠—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É ‚Äì —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –º–æ–Ω–æ–ª–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –ü–æ—ç—Ç–æ–º—É –º–Ω–æ–≥–∏–µ –∏–∑–±–µ–≥–∞—é—Ç 2PC –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—è eventual consistency –ø–æ–¥—Ö–æ–¥—ã (Saga, TCC –∏ –ø—Ä.).

–°–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ 2PC –æ—Å—Ç–∞—ë—Ç—Å—è –ø–æ–ª–µ–∑–Ω—ã–º –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö, –≥–¥–µ –Ω–µ–±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –∂—ë—Å—Ç–∫–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏. –ö –ø—Ä–∏–º–µ—Ä—É, —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–≤—É—Ö—Ñ–∞–∑–Ω—ã–π –∫–æ–º–º–∏—Ç, –µ—Å–ª–∏ –Ω–∞–ª–∏—á–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞ –ø—Ä–∏–µ–º–ª–µ–º–æ. –ù–æ –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤ 2PC ‚Äì —Ä–µ–¥–∫–∏–π –≥–æ—Å—Ç—å; —á–∞—â–µ –µ–≥–æ –∑–∞–º–µ–Ω—è—é—Ç –Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ ‚Äú–ª–æ–≥–∏—á–µ—Å–∫—É—é‚Äù –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å, –∫–∞–∫ Saga.

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ Saga –∏ 2PC

–û–±–∞ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ —Å—Ç—Ä–µ–º—è—Ç—Å—è —Ä–µ—à–∏—Ç—å –æ–¥–Ω—É –ø—Ä–æ–±–ª–µ–º—É ‚Äì –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å—Ä–µ–¥–µ, –Ω–æ –¥–µ–ª–∞—é—Ç —ç—Ç–æ –ø–æ-—Ä–∞–∑–Ω–æ–º—É. –°–≤–µ–¥—ë–º –∫–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è –≤ —Ç–∞–±–ª–∏—Ü—É:

| –ö—Ä–∏—Ç–µ—Ä–∏–π | Saga (–°–∞–≥–∞) | 2PC (–¥–≤—É—Ö—Ñ–∞–∑–Ω—ã–π –∫–æ–º–º–∏—Ç) |
|----------|------------|------------------------|
| **–ú–æ–¥–µ–ª—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏** | –ö–æ–Ω–µ—á–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å (eventual consistency): –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤. –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ –≤–æ–∑–º–æ–∂–Ω–∞ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏. | –°—Ç—Ä–æ–≥–∞—è, –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å: –ª–∏–±–æ –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —Å—Ä–∞–∑—É —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è, –ª–∏–±–æ –Ω–∏ –æ–¥–∏–Ω (–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞). –í –º–æ–º–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã. |
| **–¢–∏–ø —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** | –ù–∞–±–æ—Ä –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π + –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏. –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ, –≥–ª–æ–±–∞–ª—å–Ω–∞—è "—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è" ‚Äì —ç—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤. | –ï–¥–∏–Ω–∞—è –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –Ω–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤. –ï—Å—Ç—å –ø–æ–Ω—è—Ç–∏–µ –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ –æ–±—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–µ–π –≤—Å–µ —É–∑–ª—ã. |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–±–æ–µ–≤** | –°–∞–≥–∞ —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–∞ –∫ —á–∞—Å—Ç–∏—á–Ω—ã–º —Å–±–æ—è–º: –ø—Ä–∏ –æ—à–∏–±–∫–µ –Ω–∞ —à–∞–≥–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–º–µ–Ω—ã —Ä–∞–Ω–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π. –°–∏—Å—Ç–µ–º–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é. | 2PC –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç: –ø—Ä–∏ —Å–±–æ–µ –ª—é–±–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –æ—Ç–º–µ–Ω—è–µ—Ç –≤—Å—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (–Ω–∏ —É –∫–æ–≥–æ –Ω–µ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è). –ï—Å–ª–∏ —Å–±–æ–π –ø—Ä–æ–∏–∑–æ—à—ë–ª –ø–æ—Å–ª–µ —Ñ–∞–∑—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä (–∏–ª–∏ –∞–¥–º–∏–Ω) –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è. |
| **–ó–∞–¥–µ—Ä–∂–∫–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –ù–∏–∑–∫–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ —ç—Ç–∞–ø–∞—Ö: –∫–∞–∂–¥—ã–π —à–∞–≥ ‚Äì –±—ã—Å—Ç—Ä—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–º–∏—Ç, —Å–µ—Ä–≤–∏—Å—ã –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ. –û–±—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è (–æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –º–Ω–æ–≥–æ —à–∞–≥–æ–≤), –Ω–æ –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ —à–∞–≥–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ. | –í—ã—Å–æ–∫–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏: —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–≤–∞ —Ä–∞—É–Ω–¥–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è. –£—á–∞—Å—Ç–Ω–∏–∫–∏ –≤—ã–Ω—É–∂–¥–µ–Ω—ã –∂–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞, —É–¥–µ—Ä–∂–∏–≤–∞—è —Ä–µ—Å—É—Ä—Å—ã. –î–ª—è –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é, —á—Ç–æ –∑–∞–º–µ–¥–ª—è–µ—Ç –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π. |
| **–°–∫–∞–ª–∏—Ä—É–µ–º–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã** | –í—ã—Å–æ–∫–∞—è: Saga –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫. –° —Ä–æ—Å—Ç–æ–º —á–∏—Å–ª–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ—Ç –æ–±—â–µ–π —Ç–æ—á–∫–∏, –≥–¥–µ –≤—Å–µ –¥–æ–ª–∂–Ω—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏). –ú–æ–∂–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–∞–≥–∏. | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è: –ë–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–µ–ª–∞–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é —Ç—è–∂—ë–ª–æ–π ‚Äì –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º, —Ä–µ—Å—É—Ä—Å—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —á–∏—Å–ª—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞ –∏ —Å–µ—Ç–∏. |
| **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** | –ë–µ–∑ –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞: –≤—ã—Ö–æ–¥ –∏–∑ —Å—Ç—Ä–æ—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è–º, –Ω–æ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –º–æ–≥—É—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –¥—Ä—É–≥–∏–µ –∑–∞–¥–∞—á–∏. –°–±–æ–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–ø—Ä–∏ –µ–≥–æ –Ω–∞–ª–∏—á–∏–∏) —Ç—Ä–µ–±—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∞–≥–∏, –æ–¥–Ω–∞–∫–æ —Å–∏—Å—Ç–µ–º—É –º–æ–∂–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã —Å–∞–≥–∞ –ª–∏–±–æ –¥–æ–∂–¥–∞–ª–∞—Å—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞, –ª–∏–±–æ –æ—Ç–∫–∞—Ç–∏–ª–∞—Å—å. | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞: –≤—ã—Ö–æ–¥ –∏–∑ —Å—Ç—Ä–æ—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞ –∏–ª–∏ –ø–æ—Ç–µ—Ä—è —Å–≤—è–∑–∏ –º–æ–≥—É—Ç –æ—Å—Ç–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –≤ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ (–ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ, –Ω–æ –Ω–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ). –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Å–∞–º–∏ –ø–æ —Å–µ–±–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç—å –Ω–µ –º–æ–≥—É—Ç ‚Äì —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä. –¢–æ –µ—Å—Ç—å –æ—Ç–∫–∞–∑ –æ–¥–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞) —Å—Ç–∞–≤–∏—Ç –ø–æ–¥ —É–≥—Ä–æ–∑—É –≤—Å—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é. |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏** | –ù–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –æ—Ç –ë–î, –∫—Ä–æ–º–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –†–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ Saga, –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π. –®–∏—Ä–æ–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ ‚Äì –≤–µ–Ω–¥–æ—Ä-–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ. | –ù–∞ —É—Ä–æ–≤–Ω–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã: –¢—Ä–µ–±—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ 2PC (XA) –æ—Ç –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–°–£–ë–î, –±—Ä–æ–∫–µ—Ä–æ–≤). –ù—É–∂–µ–Ω –≤–Ω–µ—à–Ω–∏–π –∏–ª–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –í Java-–º–∏—Ä–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≥–æ—Ç–æ–≤—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (JTA, Atomikos, etc.), –Ω–æ –∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Å–ª–æ–∂–Ω—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É. –ú–Ω–æ–≥–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ NoSQL –∏–ª–∏ REST-—Å–µ—Ä–≤–∏—Å—ã –Ω–µ —É–º–µ—é—Ç –±—ã—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ 2PC. |
| **–ü—Ä–∏–º–µ—Ä—ã —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** | –°–ª–æ–∂–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã –≤ e-commerce (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤, –ø–ª–∞—Ç–µ–∂–µ–π, –¥–æ—Å—Ç–∞–≤–∫–∏), –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —É—Å–ª—É–≥), –≥–¥–µ –≤–∞–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ —à–∞–≥–∏ –∏–ª–∏ –æ—Ç–∫–∞—Ç–∏—Ç—å. –ü–æ–¥—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å. | –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É —Å—á–µ—Ç–∞–º–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö (—Ç—Ä–µ–±—É—é—Ç –∞–±—Å–æ–ª—é—Ç–Ω–æ–π –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏), —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π SQL). –ò–Ω–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –º–æ–Ω–æ–ª–∏—Ç–æ–≤ –∏–ª–∏ –∫—Ä—É–ø–Ω—ã—Ö –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º, –≥–¥–µ —Å–∏–ª—å–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. |

> (–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –í –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —ç—Ç–∏ –≥—Ä–∞–Ω–∏ –º–æ–≥—É—Ç —Ä–∞–∑–º—ã–≤–∞—Ç—å—Å—è ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä, Saga –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –∞ 2PC ‚Äì —Å —á–∞—Å—Ç–∏—á–Ω–æ–π –¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏–µ–π, –Ω–æ –≤ —Ü–µ–ª–æ–º –æ—Ç–ª–∏—á–∏—è –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–∏–µ.)

–í —Ü–µ–ª–æ–º, **Saga** –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ –≥–∏–±–∫–æ—Å—Ç—å —Ü–µ–Ω–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∞ **2PC** ‚Äì –Ω–∞ —Å—Ç—Ä–æ–≥—É—é –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Ü–µ–Ω–æ–π —É—Å–ª–æ–∂–Ω–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫. –í—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π: –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ Saga –∏–ª–∏ —Å—Ö–æ–∂–∏–µ –ø–æ–¥—Ö–æ–¥—ã –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ, —Ç–æ–≥–¥–∞ –∫–∞–∫ **2PC** ‚Äì –¥–ª—è —É–∑–∫–∏—Ö —Å–ª—É—á–∞–µ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –∞–±—Å–æ–ª—é—Ç–Ω–æ–π –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏.

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

–ü–æ–º–∏–º–æ Saga –∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ 2PC, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –¥—Ä—É–≥–∏–µ —à–∞–±–ª–æ–Ω—ã –∏ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞–∏–±–æ–ª–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ.

### –ü—Ä–æ—Ç–æ–∫–æ–ª TCC (Try-Confirm-Cancel)

**TCC (Try-Confirm-Cancel)** ‚Äì —ç—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª, –Ω–∞–ø–æ–º–∏–Ω–∞—é—â–∏–π –¥–≤—É—Ö—Ñ–∞–∑–Ω—ã–π –∫–æ–º–º–∏—Ç, –Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏. –ò–¥–µ—è TCC: –∫–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–≤–µ —Ñ–∞–∑—ã ‚Äì –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (Try) –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (Confirm) –ª–∏–±–æ –æ—Ç–º–µ–Ω—É (Cancel). –ü–æ —Å—É—Ç–∏, —ç—Ç–æ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –ª–∏–±–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º, –ª–∏–±–æ –æ—Ç–∫–∞—Ç–æ–º.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç TCC:** –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤–∏–∞–±–∏–ª–µ—Ç–∞ –∏ –æ—Ç–µ–ª—è –µ–¥–∏–Ω—ã–º –ø–∞–∫–µ—Ç–æ–º. –í –º–æ–¥–µ–ª–∏ TCC —à–∞–≥–∏ –±—É–¥—É—Ç —Ç–∞–∫–∏–º–∏:

- **Try:** –°–µ—Ä–≤–∏—Å –±–∏–ª–µ—Ç–æ–≤ –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –±—Ä–æ–Ω—å –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç –º–µ—Å—Ç–æ (–Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–¥–∞–∂—É). –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å–µ—Ä–≤–∏—Å –æ—Ç–µ–ª–µ–π —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç –Ω–æ–º–µ—Ä. –≠—Ç–∏ ‚ÄúTry‚Äù —à–∞–≥–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ ‚Äì –æ–Ω–∏ –∑–∞–Ω–∏–º–∞—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã, –ø–æ–º–µ—á–∞—è –∏—Ö –∫–∞–∫ –∑–∞–Ω—è—Ç—ã–µ, –Ω–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø–æ–∫–∞ –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π.
- **Confirm:** –ï—Å–ª–∏ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ Try –∏ –≥–æ—Ç–æ–≤—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å, —Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ Confirm –∫–∞–∂–¥–æ–º—É ‚Äì –±–∏–ª–µ—Ç—ã –≤—ã–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ, –±—Ä–æ–Ω—å –æ—Ç–µ–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è. –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å —Å–æ–≤–µ—Ä—à–∞–µ—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ.
- **Cancel:** –ï—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ –∏–∑ Try-—à–∞–≥–æ–≤ –Ω–µ —É–¥–∞–ª—Å—è (–∏–ª–∏ –æ–¥–∏–Ω –∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤ –æ—Ç–≤–µ—Ç–∏–ª, —á—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å), —Ç–æ –≤—Å–µ–º —Å–µ—Ä–≤–∏—Å–∞–º, —É–∂–µ —Å–¥–µ–ª–∞–≤—à–∏–º Try, —à–ª—ë—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ Cancel ‚Äì –æ–Ω–∏ –æ—Ç–º–µ–Ω—è—é—Ç —Ä–∞–Ω–µ–µ —Å–¥–µ–ª–∞–Ω–Ω—ã–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è (–æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç –º–µ—Å—Ç–∞, –¥–µ–Ω—å–≥–∏ –Ω–µ —Å–ø–∏—Å—ã–≤–∞—é—Ç –∏ —Ç.–¥.).

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, TCC –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏: –ª–∏–±–æ –≤—Å–µ **Confirm** –ø—Ä–æ—à–ª–∏, –ª–∏–±–æ –≤—Å–µ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–º–µ–Ω–∏–ª–æ—Å—å –Ω–∞ **Cancel**. –≠—Ç–æ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–µ –Ω–∞ **2PC** (Try —Ñ–∞–∑–∞ ‚Äì –∞–Ω–∞–ª–æ–≥ prepare, Confirm/Cancel ‚Äì commit/rollback). –ù–æ –æ—Ç–ª–∏—á–∏–µ –≤ —Ç–æ–º, —á—Ç–æ **—Ä–µ—à–µ–Ω–∏–µ –æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä, –∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**. TCC, –ø–æ —Å—É—Ç–∏, ‚Äì —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π Saga, –≥–¥–µ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã –∫–∞–∫ –æ—Ç–º–µ–Ω–∞ —Ä–µ–∑–µ—Ä–≤–æ–≤, –∏ –æ–Ω–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.

**–ü–ª—é—Å—ã TCC:**

- **–ë—ã—Å—Ç—Ä–æ—Ç–∞ –≤—ã—è–≤–ª–µ–Ω–∏—è –Ω–µ—É—Å–ø–µ—Ö–∞:** –µ—Å–ª–∏ —Ä–µ—Å—É—Ä—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —ç—Ç–∞–ø–µ Try, –º—ã —Å—Ä–∞–∑—É –∑–Ω–∞–µ–º, —á—Ç–æ –≤—Å—é –æ–ø–µ—Ä–∞—Ü–∏—é –ø—Ä–∏–¥—ë—Ç—Å—è Cancel, –∏ –Ω–µ –¥–æ–≤–æ–¥–∏–º –¥–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–ª–≥–æ–≥–æ —É–¥–µ—Ä–∂–∞–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:** —Ä–µ—Å—É—Ä—Å—ã —Ä–µ–∑–µ—Ä–≤–∏—Ä—É—é—Ç—Å—è, –Ω–æ —ç—Ç–æ —Å–∫–æ—Ä–µ–µ ‚Äú–º—è–≥–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞‚Äù —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é timeout. –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–µ—Ä–∂–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –æ—Ç–∫—Ä—ã—Ç–æ–π ‚Äì –∫–∞–∂–¥–∞—è Try —Å–∞–º–∞ –ø–æ —Å–µ–±–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç 2PC, –≥–¥–µ prepare –¥–µ—Ä–∂–∏—Ç –±–ª–æ–∫ –¥–æ commit).
- **–ö–æ–Ω—Ç—Ä–æ–ª—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:** —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —è–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç Confirm/Cancel, –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–≤—Ç–æ—Ä—è—Ç—å –ø–æ–ø—ã—Ç–∫–∏, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ç–∞–π–º-–∞—É—Ç –Ω–∞ –æ–∂–∏–¥–∞–Ω–∏–µ Confirm –∏ —Ç–æ–≥–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ Cancel).

**–ú–∏–Ω—É—Å—ã TCC:**

- **–£—Å–ª–æ–∂–Ω–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤:** –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å-—É—á–∞—Å—Ç–Ω–∏–∫ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ç—Ä–∏ –º–µ—Ç–æ–¥–∞: Try, Confirm, Cancel. –≠—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Å–µ—Ä–≤–∏—Å–∞. –ü–æ —Å—É—Ç–∏, —Å–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–≤—É–º—è —Ñ–∞–∑–∞–º–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–∞–∂–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–≤–æ–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ä–≤–∏—Å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–µ–ª—è: Try ‚Äì –¥–µ—Ä–∂–∏—Ç –Ω–æ–º–µ—Ä X –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–º, Confirm ‚Äì –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –ø–æ–º–µ—á–∞–µ—Ç –∫–∞–∫ –∑–∞–Ω—è—Ç—ã–π –æ–ø–ª–∞—á–µ–Ω–Ω—ã–π, Cancel ‚Äì —Å–Ω–∏–º–∞–µ—Ç –±—Ä–æ–Ω—å.
- **–†–µ–∑–µ—Ä–≤—ã –∏ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏:** –ï—Å–ª–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω—ã—Ö Try —á—Ç–æ-—Ç–æ –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∏–µ–Ω—Ç –¥—É–º–∞–µ—Ç, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—Ç—å –∏–ª–∏ –Ω–µ—Ç), –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã –¥—Ä—É–≥–∏–º. –ù—É–∂–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–∞–π–º-–∞—É—Ç–æ–≤: –µ—Å–ª–∏ Confirm –Ω–µ –ø—Ä–∏—à—ë–ª –∑–∞ –æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å Cancel. –ò–Ω–∞—á–µ ‚Äú–ø—Ä–∏–∑—Ä–∞–∫–∏‚Äù —Ä–µ–∑–µ—Ä–≤–æ–≤ –±—É–¥—É—Ç –≤–∏—Å–µ—Ç—å.
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–±–æ–µ–≤ –∏ –ø–æ–≤—Ç–æ—Ä–æ–≤:** –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –ø–æ–ª—É—á–∏–ª Confirm, –∞ –æ—Ç–≤–µ—Ç –ø–æ—Ç–µ—Ä—è–ª—Å—è ‚Äì –ø–æ–≤—Ç–æ—Ä–Ω—ã–π Confirm –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –æ—à–∏–±–∫–µ (–æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∂–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã). –ï—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ Cancel –Ω–µ –¥–æ—à—ë–ª, —Ä–µ—Å—É—Ä—Å –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è –∑–∞–ª–æ—á–µ–Ω–Ω—ã–º ‚Äì –Ω—É–∂–Ω—ã –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏. –¢–æ –µ—Å—Ç—å –ø–æ —Å—É—Ç–∏ —Ç–µ –∂–µ –ø—Ä–æ–±–ª–µ–º—ã, —á—Ç–æ –∏ Saga: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é –≤—Ä—É—á–Ω—É—é.
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:** TCC —É–¥–æ–±–Ω–æ, –∫–æ–≥–¥–∞ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∏–º–µ–Ω–Ω–æ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ. –≠—Ç–æ —Ç–∏–ø–∏—á–Ω–æ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π, –æ–ø–ª–∞—Ç—ã (—Ä–µ–∑–µ—Ä–≤ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –∫–∞—Ä—Ç–µ), –≤—ã–¥–µ–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤. –ù–æ –Ω–µ –≤—Å—è–∫—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ –≤–∏–¥–µ ‚Äú—Å–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å, –ø–æ—Ç–æ–º –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å‚Äù. –ù–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–∫—É email –∏–ª–∏ –∑–∞–ø–∏—Å—å –≤ –ª–æ–≥ –Ω–µ–ª—å–∑—è ‚Äú–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å‚Äù, –∏—Ö –ø—Ä–∏–¥—ë—Ç—Å—è –¥–µ–ª–∞—Ç—å –ª–∏–±–æ –∫–∞–∫ Saga —Å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–µ–π, –ª–∏–±–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Å–ª—É—á–∞–µ –æ—Ç–º–µ–Ω—ã.

## –ü–∞—Ç—Ç–µ—Ä–Ω Outbox (Transactional Outbox)

–ü—Ä–æ–±–ª–µ–º–∞ **–¥–≤–æ–π–Ω–æ–π –∑–∞–ø–∏—Å–∏ (dual-write)** ‚Äì –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö: –∫–∞–∫ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏—è/—Å–æ–æ–±—â–µ–Ω–∏—è –≤ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–∏—Å –ø—Ä–æ–∏–∑–æ–π–¥—É—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ? –ù–∞–ø—Ä–∏–º–µ—Ä, Order Service —Å–æ—Ö—Ä–∞–Ω–∏–ª –∑–∞–∫–∞–∑ –≤ —Å–≤–æ–µ–π –ë–î –∏ –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ ¬´OrderCreated¬ª –≤ Kafka –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤. –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –≤ –ë–î –ø—Ä–æ—à–ª–∞, –∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å (—Å–µ—Ç—å –º–æ—Ä–≥–Ω—É–ª–∞) ‚Äì –¥–∞–Ω–Ω—ã–µ —É–∂–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, –∞ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã –æ–± —ç—Ç–æ–º –Ω–µ —É–∑–Ω–∞—é—Ç. –ò –Ω–∞–æ–±–æ—Ä–æ—Ç, –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —É—à–ª–æ, –∞ –±–∞–∑–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å ‚Äì –¥—Ä—É–≥–∏–µ —É–∑–Ω–∞—é—Ç –æ –∑–∞–∫–∞–∑–µ, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π 2PC –º–µ–∂–¥—É –ë–î –∏ –±—Ä–æ–∫–µ—Ä–æ–º –±—ã–≤–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (—Å–∫–∞–∂–µ–º, Kafka –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç XA —Å –≤–∞—à–µ–π –ë–î). **–ü–∞—Ç—Ç–µ—Ä–Ω Outbox** —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è, —á—Ç–æ –±–∞–∑–∞ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Å—Ç–∞—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã.

–°—É—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω–∞ **Outbox**: –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–µ—Ä–≤–∏—Å —Å–Ω–∞—á–∞–ª–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω—ë–º –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π **—Ç–∞–±–ª–∏—Ü–µ Outbox** –≤ —Å–≤–æ–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ –≤ **—Ä–∞–º–∫–∞—Ö —Ç–æ–π –∂–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**, —á—Ç–æ –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ó–∞—Ç–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ –ø–æ—Ç–æ–∫ —á–∏—Ç–∞–µ—Ç —ç—Ç—É —Ç–∞–±–ª–∏—Ü—É –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏–º –∞–¥—Ä–µ—Å–∞—Ç–∞–º. –ê–ª–≥–æ—Ä–∏—Ç–º:

1. **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è:** –í —Å–µ—Ä–≤–∏—Å –ø–æ—Å—Ç—É–ø–∞–µ—Ç –∑–∞–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑). –°–µ—Ä–≤–∏—Å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –∫ —Å–≤–æ–µ–π –ë–î. –í –Ω–µ–π –æ–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±—ã—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (—Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –∑–∞–∫–∞–∑–∞) –∏ **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É Outbox** ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä, JSON —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–æ–±—ã—Ç–∏–∏ ¬´OrderCreated¬ª, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–¥–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å, –∏ —Å—Ç–∞—Ç—É—Å ‚Äú–Ω–æ–≤–æ–µ‚Äù. –ó–∞—Ç–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∫–æ–º–º–∏—Ç–∏—Ç—Å—è. –ï—Å–ª–∏ –ø–æ –∫–∞–∫–∏–º-—Ç–æ –ø—Ä–∏—á–∏–Ω–∞–º –±–∞–∑–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å ‚Äì —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–∏ –∑–∞–∫–∞–∑, –Ω–∏ —Å–æ–±—ã—Ç–∏–µ –≤ Outbox –Ω–µ –∑–∞–ø–∏—Å–∞–ª–∏—Å—å. –ï—Å–ª–∏ –∫–æ–º–º–∏—Ç —É—Å–ø–µ—à–µ–Ω ‚Äì –∏ –∑–∞–∫–∞–∑, –∏ –∑–∞–ø–∏—Å—å –æ —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–∞–¥–µ–∂–Ω–æ –≤ –±–∞–∑–µ.
2. **–û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑ Outbox:** –û—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äì –Ω–∞–∑–æ–≤—ë–º –µ–≥–æ Outbox Processor ‚Äì –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (–∏–ª–∏ –ø–æ —Ç—Ä–∏–≥–≥–µ—Ä—É) —Å—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Outbox. –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ –æ–Ω –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –±—Ä–æ–∫–µ—Ä –∏–ª–∏ –≤—ã–∑—ã–≤–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–º–µ—á–∞–µ—Ç –∑–∞–ø–∏—Å—å Outbox –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é (–∏–ª–∏ —É–¥–∞–ª—è–µ—Ç –µ–µ). –≠—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è —Ç–æ–∂–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±–∞–∑–µ.

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è **–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –∫–æ–Ω–µ—á–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞**: –ª–∏–±–æ –∑–∞–∫–∞–∑ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —ç—Ç–æ–º –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ, –ª–∏–±–æ –µ—Å–ª–∏ –∑–∞–∫–∞–∑ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è, —Ç–æ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –±—ã–ª–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ (–Ω–µ –ø–æ—è–≤–∏–ª–æ—Å—å –≤ Outbox). –î–∞–∂–µ –µ—Å–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –±—Ä–æ–∫–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞, –∑–∞–ø–∏—Å—å –Ω–∞–¥—ë–∂–Ω–æ –ª–µ–∂–∏—Ç –≤ –±–∞–∑–µ –∏ –¥–æ–∂–¥—ë—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–ø—ã—Ç–∫–∏. –ú—ã —É—Å—Ç—Ä–∞–Ω—è–µ–º —Å–∏—Ç—É–∞—Ü–∏—é —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∞ –º–µ–∂–¥—É –ë–î –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Outbox-–ø–∞—Ç—Ç–µ—Ä–Ω–∞:**

- **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (at-least-once):** –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è, –ø–æ–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ë–î —Å–æ—Å—Ç–æ—è–ª–∞—Å—å. –ï—Å–ª–∏ –±—Ä–æ–∫–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É, –∫–æ–≥–¥–∞ –æ–Ω –ø–æ—è–≤–∏—Ç—Å—è. –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ—Ç–µ—Ä—è—é—Ç—Å—è ‚Äì –æ–Ω–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ Outbox. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–µ—Ä–≤–∏—Å—ã –Ω–∞–¥–µ–∂–Ω–æ –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è —Å–æ–±—ã—Ç–∏—è–º–∏, –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–∞—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
- **–ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ –∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è:** –í —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π –ª–æ–∫–∞–ª—å–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –º—ã –¥–æ–±–∏–≤–∞–µ–º—Å—è, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞) –Ω–µ–æ—Ç–¥–µ–ª–∏–º–æ –æ—Ç –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–æ–±—ã—Ç–∏—è –≤ –æ—á–µ—Ä–µ–¥—å –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É. –ü–æ–ª—É—á–∞–µ—Ç—Å—è –∞–Ω–∞–ª–æ–≥ ‚Äú–º–∏–Ω–∏-2PC‚Äù –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π –±–∞–∑—ã, —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—â–µ –∏ –Ω–∞–¥—ë–∂–Ω–µ–µ.
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** Outbox –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ ‚Äì —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏ —Ñ–æ–Ω–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å. –ú–Ω–æ–≥–∏–µ —Ä–µ–∞–ª–∏–∑—É—é—Ç —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º—ã Change Data Capture: –Ω–∞–ø—Ä–∏–º–µ—Ä, Debezium –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –ª–æ–≥ –±–∞–∑—ã –∏ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –≤ Kafka, –≤–æ–æ–±—â–µ –±–µ–∑ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞ ‚Äú–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞‚Äù. –¢–æ –µ—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–≤–æ–ª—å–Ω–æ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ–π.

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ Outbox-–ø–∞—Ç—Ç–µ—Ä–Ω–∞:**

- **–ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ Outbox:** –ù—É–∂–Ω–æ –≤—ã–¥–µ–ª—è—Ç—å –º–µ—Å—Ç–æ –≤ –±–∞–∑–µ –ø–æ–¥ —ç—Ç—É —Ç–∞–±–ª–∏—Ü—É, —á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏, —Å–ª–µ–¥–∏—Ç—å –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é. –í —Å—É—â–Ω–æ—Å—Ç–∏, –º—ã –≤–Ω–µ–¥—Ä—è–µ–º –º–µ—Ö–∞–Ω–∏–∑–º –æ—á–µ—Ä–µ–¥–∏/–∂—É—Ä–Ω–∞–ª–∞ –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞ ‚Äì —ç—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.
- **At-least-once —Å–µ–º–∞–Ω—Ç–∏–∫–∞:** –û–±—ã—á–Ω–æ Outbox –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–Ω–æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –í–æ–∑–º–æ–∂–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã (–µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —É–ø–∞–ª –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏, –Ω–æ –¥–æ –æ—Ç–º–µ—Ç–∫–∏ ‚Äú–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ‚Äù ‚Äì –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –æ–Ω –ø–æ–ø—Ä–æ–±—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–Ω–æ–≤–∞). –ü–æ—ç—Ç–æ–º—É –ø–æ–ª—É—á–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≥–æ—Ç–æ–≤—ã –∫ –¥—É–±–ª–∏–∫–∞—Ç–∞–º (–¥–µ–ª–∞—Ç—å –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—é –∏–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è ‚Äì –∞ —ç—Ç–æ –æ–ø—è—Ç—å –∂–µ –≤–æ–ø—Ä–æ—Å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤). –î–æ—Å—Ç–∏—á—å —Å—Ç—Ä–æ–≥–æ–≥–æ exactly-once —Å–ª–æ–∂–Ω–æ, —Ö–æ—Ç—è –µ—Å—Ç—å —Ç–µ—Ö–Ω–∏–∫–∏ (–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Inbox-—Ç–∞–±–ª–∏—Ü–∞–º–∏ –Ω–∞ –ø—Ä–∏–Ω–∏–º–∞—é—â–µ–π —Å—Ç–æ—Ä–æ–Ω–µ, –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ ID —Å–æ–æ–±—â–µ–Ω–∏—è).
- **–ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –æ—Å–Ω–æ–≤–Ω—ã–º —Å–æ–±—ã—Ç–∏–µ–º –∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ–º:** –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑ Outbox –º–æ–∂–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –Ω–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –∞ —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —á–∞—Å—Ç–æ—Ç—ã –æ–ø—Ä–æ—Å–∞ –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ CDC). –û–±—ã—á–Ω–æ —ç—Ç–æ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã-—Å–µ–∫—É–Ω–¥—ã, —á—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ –¥–ª—è –æ—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–∏—Å—Ç–µ–º –º–æ–∂–µ—Ç –±—ã—Ç—å —Ñ–∞–∫—Ç–æ—Ä–æ–º.

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —ç—Ç–∏ –º–∏–Ω—É—Å—ã, Outbox-–ø–∞—Ç—Ç–µ—Ä–Ω —Å—Ç–∞–ª **–¥–µ-—Ñ–∞–∫—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º** –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –Ω–∞–¥—ë–∂–Ω—ã—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏. –û–Ω –æ—Å–æ–±–µ–Ω–Ω–æ —Ö–æ—Ä–æ—à–æ –¥–æ–ø–æ–ª–Ω—è–µ—Ç Saga: –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å —á–µ—Ä–µ–∑ Outbox –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ, –∑–∞–ø—É—Å–∫–∞—é—â–µ–µ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ Saga –≤ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–∏—Å–µ, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—è, —á—Ç–æ –Ω–∏ –æ–¥–∏–Ω —à–∞–≥ –Ω–µ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è.

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: –∫–∞–∫ –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥

–ü—Ä–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã –∏–∑ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π, —Å—Ç–æ–∏—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —Ä—è–¥–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:

- **–ü–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–∑–±–µ–≥–∞–π—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:** –°—Ç–∞—Ä–∞–π—Ç–µ—Å—å —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –∏ –¥–∞–Ω–Ω—ã–µ —Ç–∞–∫, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –æ–¥–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤. –ò–Ω–æ–≥–¥–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã —Å–µ—Ä–≤–∏—Å–æ–≤ –∏–ª–∏ –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ–±—ã —É–ª–æ–∂–∏—Ç—å—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é. –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ ‚Äì –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.
- **–û—Ü–µ–Ω–∏–≤–∞–π—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏:** –ù–µ –≤—Å–µ–≥–¥–∞ –Ω—É–∂–Ω–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å. –ï—Å–ª–∏ –±–∏–∑–Ω–µ—Å –¥–æ–ø—É—Å–∫–∞–µ—Ç –Ω–µ–±–æ–ª—å—à–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è, –ª—É—á—à–µ –≤—ã–±—Ä–∞—Ç—å Saga –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω —Å eventual consistency. –°—Ç—Ä–æ–≥—É—é –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å (2PC) –æ—Å—Ç–∞–≤—å—Ç–µ –¥–ª—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤. –ü–æ–º–Ω–∏—Ç–µ: ACID –≤ –º–∞—Å—à—Ç–∞–±–∞—Ö –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –æ–±—ã—á–Ω–æ –∂–µ—Ä—Ç–≤—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é. –ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è (–≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ), –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≥–æ—Ç–æ–≤—ã –ø—Ä–∏–Ω—è—Ç—å, —á—Ç–æ —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –æ–±–Ω–æ–≤–∏—Ç—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä—É —Å–µ–∫—É–Ω–¥, –ª–∏—à—å –±—ã —Å–∞–º–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–ª–æ –±—ã—Å—Ç—Ä–æ –∏ –Ω–µ –ø–∞–¥–∞–ª–æ.
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Saga –¥–ª—è –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤:** Saga-–ø–∞—Ç—Ç–µ—Ä–Ω –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Ü–µ–ø–æ—á–µ–∫ –¥–µ–π—Å—Ç–≤–∏–π: –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤, –±–∏–ª–ª–∏–Ω–≥, —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –≥–¥–µ —à–∞–≥–∏ —á–µ—Ç–∫–æ –≤—ã–¥–µ–ª–µ–Ω—ã. –û–Ω —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –∫–æ–¥–∞ (–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏), –Ω–æ —ç—Ç–æ—Ç –∫–æ–¥ —è–≤–Ω–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫. –ï—Å–ª–∏ —É –≤–∞—Å 3-5 —Å–µ—Ä–≤–∏—Å–æ–≤, —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö –≤ –æ–¥–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏, Saga –≤–µ—Ä–æ—è—Ç–Ω–æ –±—É–¥–µ—Ç —É–¥–∞—á–Ω—ã–º –≤—ã–±–æ—Ä–æ–º. –ù–∞—á–∏–Ω–∞—é—â–∏–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞–º Saga –±–æ–ª–µ–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞, —á–µ–º –Ω–∞–∫—Ä—É—Ç–∫–∞ XA-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.
- **–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è vs —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—è:** –ù–∞ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–æ—â–µ –ø–æ–Ω—è—Ç—å –∏ –æ—Ç–ª–∞–¥–∏—Ç—å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é ‚Äì –∫–æ–≥–¥–∞ –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å (–∏–ª–∏ –º–æ–¥—É–ª—å) —Ä—É–∫–æ–≤–æ–¥–∏—Ç –≤—Å–µ–º–∏ —à–∞–≥–∞–º–∏. –û–¥–Ω–∞–∫–æ —Å–ª–µ–¥–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª—Å—è –≤ ‚Äú–±–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç‚Äù, –∑–Ω–∞—é—â–∏–π –ø—Ä–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏–∑–±—ã—Ç–æ—á–Ω–æ. –•–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—è –≤ –±–æ–ª—å—à–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –Ω–æ –±—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å "–ª–∞–≤–∏–Ω–æ–π —Å–æ–±—ã—Ç–∏–π". –•–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ ‚Äì –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π Saga-—Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏, —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–Ω–∏–º–∞–ª–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
- **TCC –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤:** –ï—Å–ª–∏ –≤–∞—à —Å—Ü–µ–Ω–∞—Ä–∏–π –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –Ω–∞ ‚Äú—Ä–µ–∑–µ—Ä–≤ –∏ –ø–æ—Ç–≤–µ—Ä–¥–∏—Ç—å/–æ—Ç–º–µ–Ω–∏—Ç—å‚Äù ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤, –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Å–∫–∏–¥–æ–∫ ‚Äì —Ç–æ TCC –º–æ–∂–µ—Ç –±—ã—Ç—å —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º. –ù–æ –±—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–∞–π–º-–∞—É—Ç—ã –∏ –æ—á–∏—Å—Ç–∫—É —Ä–µ–∑–µ—Ä–≤–æ–≤. TCC –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, —Ç–æ –µ—Å—Ç—å –≤–æ–æ–±—â–µ –Ω–µ –¥–æ–≤–æ–¥–∏—Ç—å –¥–µ–ª–æ –¥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —É –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.
- **–ò–∑–±–µ–≥–∞–π—Ç–µ —á—Ä–µ–∑–º–µ—Ä–Ω–æ–≥–æ 2PC:** –ó–∞–ø—É—Å–∫ 2PC –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ –æ–ø—Ä–∞–≤–¥–∞–Ω –∫—Ä–∞–π–Ω–µ —Ä–µ–¥–∫–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –≤–∞—Å –¥–≤–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –±–∞–∑—ã (—Å–∫–∞–∂–µ–º, –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è –∏ —Å–∫–ª–∞–¥ –¥–æ–ª–∂–Ω—ã –º–µ–Ω—è—Ç—å—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ —É –≤–∞—Å –µ—Å—Ç—å –≥–æ—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è XA) ‚Äì —Ç–æ–≥–¥–∞ –¥–∞. –ù–æ –≤–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö —Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å —Ä–µ—à–∏—Ç—å –≤–æ–ø—Ä–æ—Å –ª–∏–±–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Saga/TCC), –ª–∏–±–æ —á–µ—Ä–µ–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –û–ø—ã—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Å–∏—Å—Ç–µ–º—ã, —Å–∏–ª—å–Ω–æ –∑–∞–≤—è–∑–∞–Ω–Ω—ã–µ –Ω–∞ 2PC, —Ç—Ä—É–¥–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å.
- **–ü–∞—Ç—Ç–µ—Ä–Ω Outbox ‚Äì ‚Äúmust have‚Äù –¥–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä—ã:** –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—Å–µ–≥–¥–∞, –∫–æ–≥–¥–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è —Å–æ–±—ã—Ç–∏—è–º–∏ –∏–ª–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏, —Å—Ç–æ–∏—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å Outbox (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ publish-confirm –º–µ—Ö–∞–Ω–∏–∑–º—ã). –≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è. –ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –ø–∏—Å–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π Outbox-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –±–∞–∑–µ Debezium (CDC) –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ (–≤ –º–∏—Ä–µ .NET, Java –µ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏). –ù–æ –Ω–µ –ø—Ä–µ–Ω–µ–±—Ä–µ–≥–∞–π—Ç–µ –ø—Ä–æ–±–ª–µ–º–æ–π –¥–≤–æ–π–Ω–æ–π –∑–∞–ø–∏—Å–∏ ‚Äì –æ–Ω–∞ –æ—á–µ–Ω—å –∫–æ–≤–∞—Ä–Ω–∞ –∏ –ª–µ–≥–∫–æ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è.
- **Idempotency everywhere:** –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π. –ë—É–¥—å —Ç–æ Saga –∏–ª–∏ TCC, –∏–ª–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å Outbox-—Å–æ–æ–±—â–µ–Ω–∏–π ‚Äì –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≤–æ–∑–º–æ–∂–Ω—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –æ–ø–µ—Ä–∞—Ü–∏–π, —Å—Ç–∞—Ç—É—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏ (‚Äú—É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ‚Äù) –∏–ª–∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã deduplication. –ü—Ä–æ—â–µ –∑–∞–ª–æ–∂–∏—Ç—å —ç—Ç–æ —Å—Ä–∞–∑—É, —á–µ–º –ø–æ—Ç–æ–º —É—Å—Ç—Ä–∞–Ω—è—Ç—å –±–∞–≥–∏ ‚Äú–¥–≤–æ–π–Ω–æ–≥–æ —Å–ø–∏—Å–∞–Ω–∏—è –¥–µ–Ω–µ–≥‚Äù.
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞:** –í–Ω–µ–¥—Ä–∏—Ç–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π ‚Äì –±—É–¥—å —Ç–æ ID —Å–∞–≥–∏, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–ª–∏ –∑–∞–∫–∞–∑–∞. –ü–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –µ–≥–æ —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –ª–æ–≥–∏ –∏ –ø—Ä. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (Jaeger, Zipkin, etc.) –ø–æ–º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å ‚Äú—Ü–µ–ø–æ—á–∫—É‚Äù –∑–∞–ø—Ä–æ—Å–æ–≤ –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ ‚Äì –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∏—Ö –Ω–∞ —ç—Ç–∞–ø–∞—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –≠—Ç–æ —Å–ø–∞—Å–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.
- **–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:** –ï—Å–ª–∏ —É –≤–∞—Å —Å–∞–≥–∏ –∏–ª–∏ TCC, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –¥–ª–∏—Ç—å—Å—è –¥–æ–ª–≥–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —á—Ç–æ-—Ç–æ –∏–ª–∏ –∂–¥–µ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ –æ—Ç–≤–µ—Ç–∞), —Å—Ç–∞–≤—å—Ç–µ —Ä–∞–∑—É–º–Ω—ã–µ —Å—Ä–æ–∫–∏ –∂–∏–∑–Ω–∏. ‚Äú–ó–∞–≤–∏—Å—à–∏–µ‚Äù –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–Ω–∏–º–∞—é—Ç —Ä–µ—Å—É—Ä—Å—ã –∏ –º–æ–≥—É—Ç –∑–∞–ø—É—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ Saga –Ω–µ –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –∏–∑-–∑–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º ‚Äì –≤–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–æ–∏—Ç –æ—Ç–º–µ–Ω–∏—Ç—å –µ—ë –∏ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ —Å–ø—É—Å—Ç—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è (fallback strategy).
- **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤ API –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ:** –ï—Å–ª–∏ –≤–∞—à —Å–µ—Ä–≤–∏—Å –ø–æ –≤–Ω–µ—à–Ω–µ–º—É API –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, Saga), —á–µ—Ç–∫–æ –æ–ø–∏—à–∏—Ç–µ, —á—Ç–æ –æ—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏ —Ä–∞–Ω—å—à–µ, —á–µ–º –≤—Å–µ –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã –∑–Ω–∞—é—Ç –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ. –•–æ—Ä–æ—à–∏–π –ø—Ä–∏–º–µ—Ä ‚Äì –æ–ø–ª–∞—Ç–∞: —Å—Ä–∞–∑—É –æ—Ç–≤–µ—á–∞–µ–º ‚Äú–ø–ª–∞—Ç—ë–∂ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è‚Äù, –∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –ø—Ä–∏–¥—ë—Ç –ø–æ–∑–∂–µ. –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–Ω—É—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–º–∏ —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è.


## –†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É: –æ–±–∑–æ—Ä

<img src="./static/diagrams/saga_0.svg" alt="saga_0_overview">

```graph
graph TD
    A[Client] --> B[Order Service]
    B --> C[Catalog Service]
    B --> D[Payment Service]
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ SAGA

<img src="./static/diagrams/saga_1.svg" alt="saga_first_overview">

```sequence
sequenceDiagram
    participant Client
    participant OrderService
    participant CatalogService
    participant PaymentService

    Client->>OrderService: –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ (POST /orders)
    OrderService->>CatalogService: –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã (PUT /catalog/reserve)
    CatalogService-->>OrderService: –¢–æ–≤–∞—Ä—ã –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã
    OrderService->>PaymentService: –°–ø–∏—Å–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ (POST /payment/charge)
    PaymentService-->>OrderService: –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–µ–Ω
    OrderService->>Client: –ó–∞–∫–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### Order Service

–†–æ–ª—å: –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä SAGA, —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–º –∑–∞–∫–∞–∑–∞.

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**

```go
func (s *OrderService) CreateOrder() error {
    // 1. –†–µ–∑–µ—Ä–≤–∏—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã
    if err := s.catalog.ReserveItems(); err != nil {
        return err
    }
    
    // 2. –°–ø–∏—Å—ã–≤–∞–µ–º —Å—Ä–µ–¥—Å—Ç–≤–∞
    if err := s.payment.Charge(); err != nil {
        s.catalog.CancelReservation() // –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏–æ–Ω–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
        return err
    }
    
    return nil
}
```

#### Catalog Service

–†–æ–ª—å: –£–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Å—Ç–∞—Ç–∫–∞–º–∏ —Ç–æ–≤–∞—Ä–æ–≤.

#### Payment Service

–†–æ–ª—å: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–ª–∞—Ç–µ–∂–∏.

#### –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—Å—Ç–∏

<img src="./static/diagrams/saga_2.svg" alt="saga_second_overview">

```sequence
sequenceDiagram
    participant OrderService
    participant Kafka
    participant CatalogService
    participant PaymentService

    OrderService->>Kafka: OrderCreated (SAGA_START)
    Kafka->>CatalogService: ReserveItems
    CatalogService->>Kafka: ItemsReserved / ReserveFailed
    Kafka->>PaymentService: ChargePayment (–µ—Å–ª–∏ ReserveSuccess)
    PaymentService->>Kafka: PaymentProcessed / PaymentFailed
    Kafka->>OrderService: SAGA_COMPLETE / SAGA_ROLLBACK
```

## –ü—Ä–æ–±–ª–µ–º—ã –±–∞–∑–æ–≤–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç **–ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**
- **–ö–∞—Å–∫–∞–¥–Ω—ã–µ –æ—à–∏–±–∫–∏** –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- **–ü–æ—Ç–µ—Ä—è —Å–æ–±—ã—Ç–∏–π** –ø—Ä–∏ —Å–±–æ—è—Ö
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏—Å—Ç–æ—Ä–∏–∏** –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

- –î–æ–±–∞–≤–∏—Ç—å Idempotency Key –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π.
- –í–Ω–µ–¥—Ä–∏—Ç—å Circuit Breaker –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Outbox Pattern –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π.

### –í—ã–≤–æ–¥

- ‚úÖ SAGA —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚úÖ –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–≤–æ–µ–π —á–∞—Å—Ç—å—é –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å
- ‚ö† –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º (–ª—É—á—à–µ Event Sourcing + CQRS)

### –ì–ª–æ—Å–∞—Ä–∏–π

> ##### –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (SAGA Rollback)
> –ï—Å–ª–∏ –Ω–∞ –ª—é–±–æ–º —ç—Ç–∞–ø–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∞, —Å–∏—Å—Ç–µ–º–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:
> 1. **–ü–ª–∞—Ç–µ–∂ –Ω–µ –ø—Ä–æ—à–µ–ª** ‚Üí –û—Ç–º–µ–Ω–∞ —Ä–µ–∑–µ—Ä–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ (CatalogService.CancelReservation).
> 2. **–†–µ–∑–µ—Ä–≤ –Ω–µ —É–¥–∞–ª—Å—è** ‚Üí –ó–∞–∫–∞–∑ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –±–µ–∑ —Å–ø–∏—Å–∞–Ω–∏—è –¥–µ–Ω–µ–≥.


## –£–ª—É—á—à–µ–Ω–Ω–∞—è Event-Driven SAGA

<img src="./static/diagrams/saga_6.svg" alt="saga_6_overview">

```graph
graph LR
    A[Order] -->|Events| B[Kafka]
    B --> C[Catalog]
    B --> D[Payment]
    C --> B
    D --> B
```

> –ú–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Kafka –∏–ª–∏ RabbitMQ:

<img src="./static/diagrams/saga_3.svg" alt="saga_third_overview">

```sequence
sequenceDiagram
    participant Client
    participant OrderService
    participant CatalogService
    participant PaymentService
    participant Kafka
    participant OutboxTable

    Client->>OrderService: POST /orders (idempotency-key: XYZ123)
    OrderService->>OutboxTable: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å OrderCreatedEvent
    OrderService->>Kafka: OrderCreated (SAGA_START)
    Kafka->>CatalogService: ReserveItems (—á–µ—Ä–µ–∑ CB)
    CatalogService->>OutboxTable: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ItemsReservedEvent
    CatalogService->>Kafka: ItemsReserved
    Kafka->>PaymentService: ChargePayment (—á–µ—Ä–µ–∑ CB)
    PaymentService->>OutboxTable: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å PaymentProcessedEvent
    PaymentService->>Kafka: PaymentProcessed
    Kafka->>OrderService: SAGA_COMPLETE
```

### Idempotency Key (–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å)

**–ó–∞–¥–∞—á–∞:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.
**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**

```go
// Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª—é—á–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
func IdempotencyMiddleware(next http.Handler) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        key := r.Header.Get("Idempotency-Key")
        if cached := cache.Get(key); cached != nil {
            respondWithCached(w, cached)
            return
        }
        next.ServeHTTP(w, r)
    })
}
```

### Circuit Breaker (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å)

**–ó–∞–¥–∞—á–∞:** –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö –æ—à–∏–±–æ–∫ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤.
**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**

```go
// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Catalog Service
cb := gobreaker.NewCircuitBreaker(gobreaker.Settings{
    Name:    "CatalogService",
    Timeout: 30 * time.Second,
    ReadyToTrip: func(counts gobreaker.Counts) bool {
        return counts.ConsecutiveFailures > 5
    },
})
```

### Outbox Pattern (–ù–∞–¥–µ–∂–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π)

**–ó–∞–¥–∞—á–∞:** –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –¥–∞–∂–µ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞.
**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**

```go
CREATE TABLE outbox (
    id UUID PRIMARY KEY,
    saga_id VARCHAR(255),
    event_type VARCHAR(100),
    payload JSONB,
    created_at TIMESTAMP,
    processed BOOLEAN DEFAULT false
);
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞

<img src="./static/diagrams/saga_4.svg" alt="saga_4_overview">

```graph
graph TD
    A[Client] --> B[Order Service]
    B --> C[Catalog Service]
    B --> D[Payment Service]
    B --> E[(Outbox DB)]
    C --> F[(Catalog DB)]
    D --> G[(Payment DB)]
    B --> H[Kafka]
    C --> H
    D --> H
    H --> I[SAGA Orchestrator]
    I --> B
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—Å—Ç–∏

<img src="./static/diagrams/saga_5.svg" alt="saga_5_overview">

```sequence
sequenceDiagram
    participant Client
    participant OrderService
    participant CatalogService
    participant PaymentService
    participant Kafka
    participant OutboxProcessor

    Client->>OrderService: POST /orders
    OrderService->>OrderService: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Idempotency Key
    OrderService->>OrderService: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞–∫–∞–∑ –≤ –ë–î
    OrderService->>OutboxProcessor: OrderCreated (Outbox)
    OutboxProcessor->>Kafka: OrderCreated
    Kafka->>SagaOrchestrator: OrderCreated
    SagaOrchestrator->>CatalogService: ReserveItems
    CatalogService->>CatalogService: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ
    CatalogService->>CatalogService: –†–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç —Ç–æ–≤–∞—Ä—ã
    CatalogService->>OutboxProcessor: ItemsReserved (Outbox)
    OutboxProcessor->>Kafka: ItemsReserved
    Kafka->>SagaOrchestrator: ItemsReserved
    SagaOrchestrator->>PaymentService: ProcessPayment
    PaymentService->>PaymentService: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–ª–∞—Ç–µ–∂
    PaymentService->>OutboxProcessor: PaymentProcessed (Outbox)
    OutboxProcessor->>Kafka: PaymentProcessed
    Kafka->>SagaOrchestrator: PaymentProcessed
    SagaOrchestrator->>OrderService: CompleteOrder
    OrderService->>OrderService: –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
    OrderService->>Client: 200 OK
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ü–æ–¥—Ö–æ–¥              | –î–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–∞ | –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏  |
|---------------------|---|---|
| **–ë–∞–∑–æ–≤–∞—è SAGA**    | –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  | –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è  |
| **–° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏** | –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å | –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç  |

## –ü–µ—Ä–µ—Ö–æ–¥ –∫ CQRS –∏ Event Sourcing

### CQRS: —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

<img src="./static/diagrams/cqrs.svg" alt="cqrs_overview">

```graph
graph TB
    A[Command] --> B[Command Handler]
    B --> C[Event Store]
    C --> D[Read Model]
    E[Query] --> F[Read Model]
```

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**

```go
package main

// Command Side
type CreateOrderCommand struct {
    UserID uuid.UUID
    Items  []OrderItem
}

type OrderCommandHandler struct {
    eventStore EventStore
}

func (h *OrderCommandHandler) Handle(cmd CreateOrderCommand) error {
    events := []Event{
        NewEvent("OrderCreated", cmd),
    }
    return h.eventStore.Append(events)
}

// Query Side
type OrderReadModel struct {
    db *sql.DB
}

func (r *OrderReadModel) GetByID(id uuid.UUID) (OrderView, error) {
    // Query from optimized read storage
}
```

### –ì–ª–æ—Å–∞—Ä–∏–π

> –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è: 
> 
> **Commands** - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
> 
> **Queries** - —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

Queries - —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## Event Sourcing: –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥

### –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

**–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã** = –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π

```go
type EventStore interface {
    Append(event Event) error
    GetStream(aggregateID string) ([]Event, error)
}

type Event struct {
    ID          uuid.UUID
    Type        string
    AggregateID string
    Data        []byte
    Version     uint64
    Timestamp   time.Time
}
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–≥—Ä–µ–≥–∞—Ç–∞

```go
type OrderAggregate struct {
    ID      uuid.UUID
    Version uint64
    State   OrderState
}

func (a *OrderAggregate) Apply(event Event) error {
    switch event.Type {
    case "OrderCreated":
        var data OrderCreatedData
        json.Unmarshal(event.Data, &data)
        a.State = OrderState{Status: "created"}
    case "PaymentProcessed":
        a.State.Status = "paid"
    }
    a.Version = event.Version
    return nil
}
```

## –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥: Event Sourcing + CQRS

### –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

<img src="./static/diagrams/es-cqrs.svg" alt="es_cqrs_overview">

```graph
graph LR
    A[Client] --> B[Command]
    B --> C[Command Handler]
    C --> D[Event Store]
    D --> E[Event Processor]
    E --> F[Read Model]
    A --> G[Query]
    G --> F
    E --> H[Projections]
    H --> I[Analytics DB]
```

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

```go
package main

// todo
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

<img src="./static/diagrams/es-cqrs-2.svg" alt="es_cqrs_2_overview">

```sequence
sequenceDiagram
    participant Client
    participant CommandAPI
    participant CommandHandler
    participant EventStore
    participant EventProcessor
    participant ReadModel
    participant QueryAPI

    Client->>CommandAPI: POST /orders (Command)
    CommandAPI->>CommandHandler: CreateOrderCommand
    CommandHandler->>EventStore: Append Events[OrderCreated]
    EventStore-->>CommandHandler: Success
    CommandHandler-->>CommandAPI: 202 Accepted
    CommandAPI-->>Client: 202 Accepted

    loop Async Processing
        EventProcessor->>EventStore: Poll New Events
        EventStore-->>EventProcessor: OrderCreatedEvent
        EventProcessor->>ReadModel: Update Projection
        EventProcessor->>ReadModel: Update MaterializedView
    end

    Client->>QueryAPI: GET /orders/{id} (Query)
    QueryAPI->>ReadModel: GetOrderView
    ReadModel-->>QueryAPI: OrderView
    QueryAPI-->>Client: 200 OK (DTO)
```

### –¢–µ–∫—Å—Ç–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã:

> 1. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É:
>
>    `Client ‚Üí CommandAPI: POST /orders {items: [...]}`
> 2. Command API –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É:
>
>    `CommandAPI ‚Üí CommandHandler: CreateOrderCommand`
> 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–±—ã—Ç–∏—è:
>
>    `CommandHandler ‚Üí EventStore: Append [OrderCreatedEvent]`
> 4. EventStore –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å:
>
>    `EventStore ‚Üí CommandHandler: Success`
> 5. –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:
>
>    `CommandHandler ‚Üí CommandAPI ‚Üí Client: 202 Accepted`
> 6. –§–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π:
>    - **EventProcessor** –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç **EventStore**
>    - –ü–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è (`OrderCreatedEvent`)
>    - –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ–µ–∫—Ü–∏–∏ –≤ **ReadModel**
> 7. –ö–ª–∏–µ–Ω—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ:
>
>    `Client ‚Üí QueryAPI: GET /orders/123`
> 8. Query API –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ ReadModel:
>
>    `QueryAPI ‚Üí ReadModel: GetOrderView(123)`
> 9. –î–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É:
>
>    `ReadModel ‚Üí QueryAPI ‚Üí Client: OrderViewDTO`

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ—Ç–æ–∫–∞:

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π –∑–∞–ø–∏—Å–∏ –∏ —á—Ç–µ–Ω–∏—è:**
    - –ó–∞–ø–∏—Å—å –∏–¥–µ—Ç —á–µ—Ä–µ–∑ Command Stack (–ª–µ–≤–∞—è —á–∞—Å—Ç—å)
    - –ß—Ç–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Query Stack (–ø—Ä–∞–≤–∞—è —á–∞—Å—Ç—å)

2. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:**
    - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ReadModel –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ —Ñ–∏–∫—Å–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π
    - –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø–∏—Å—å—é –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é —á—Ç–µ–Ω–∏—è (Eventual Consistency)
3. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
    - `EventStore` - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ–±—ã—Ç–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, Kafka+PostgreSQL)
    - `EventProcessor` - –ø–æ–¥–ø–∏—Å—á–∏–∫ –Ω–∞ —Å–æ–±—ã—Ç–∏—è (Consumer)
    - `ReadModel` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —á—Ç–µ–Ω–∏—è (MongoDB/Elasticsearch)

### –¢–∏–ø–æ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏:

<img src="./static/diagrams/es-cqrs-latency.svg" alt="es_cqrs_3_overview">

```timeline
timeline
    title –í—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏
    section –ó–∞–ø–∏—Å—å
    Command : 0 ms
    Event Store : 50 ms
    ReadModel Update : 100-500 ms
    section –ß—Ç–µ–Ω–∏–µ
    Query : –ü–æ—Å–ª–µ 500 ms (strong consistency)
```

## –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

| –ö—Ä–∏—Ç–µ—Ä–∏–π               | SAGA                | Event Sourcing      | CQRS                | ES+CQRS             |
|------------------------|---------------------|---------------------|---------------------|---------------------|
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å**          | –ù–∏–∑–∫–∞—è              | –í—ã—Å–æ–∫–∞—è             | –°—Ä–µ–¥–Ω—è—è             | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è       |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** |                     |                     |                     |                     |
| - –ó–∞–ø–∏—Å—å               | –°—Ä–µ–¥–Ω—è—è             | –ù–∏–∑–∫–∞—è              | –°—Ä–µ–¥–Ω—è—è             | –°—Ä–µ–¥–Ω—è—è             |
| - –ß—Ç–µ–Ω–∏–µ               | –°—Ä–µ–¥–Ω—è—è             | –ù–∏–∑–∫–∞—è              | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è       | –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è         |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**   | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞          | –û—Ç–ª–∏—á–Ω–∞—è            | –û—Ç–ª–∏—á–Ω–∞—è            | –ù–∞–∏–ª—É—á—à–∞—è           |
| **–ì–∏–±–∫–æ—Å—Ç—å**           | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞          | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è        | –í—ã—Å–æ–∫–∞—è             | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è        |
| **–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π**  | –ù–µ—Ç                 | –ü–æ–ª–Ω–∞—è              | –ß–∞—Å—Ç–∏—á–Ω–∞—è           | –ü–æ–ª–Ω–∞—è              |
| **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**    | Eventual            | Strong              | Strong              | Strong              |
| **–õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**        | –ù–∏–∑–∫–∞—è              | –í—ã—Å–æ–∫–∞—è             | –ù–∏–∑–∫–∞—è (—á—Ç–µ–Ω–∏–µ)     | –°—Ä–µ–¥–Ω—è—è             |
| **–û–±—ä–µ–º –∫–æ–¥–∞**         | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π         | –ë–æ–ª—å—à–æ–π             | –£–º–µ—Ä–µ–Ω–Ω—ã–π           | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π        |
| **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**      | –ü—Ä–æ—Å—Ç—ã–µ workflows   | –ê—É–¥–∏—Ç/–∞–Ω–∞–ª–∏—Ç–∏–∫–∞     | –û—Ç—á–µ—Ç—ã              | –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã |

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é

1. –°—Ç–∞—Ä—Ç–∞–ø—ã: SAGA + Circuit Breaker
2. –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç—ã: –î–æ–±–∞–≤–∏—Ç—å Event Sourcing –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –∞–≥—Ä–µ–≥–∞—Ç–æ–≤
3. –°–ª–æ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã: –ü–æ–ª–Ω—ã–π ES+CQRS —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ü–∏—è–º–∏

<img src="./static/diagrams/recommendations.svg" alt="es_cqrs_overview">

```graph
graph TD
    A[–í—ã–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã] --> B{–ö—Ä–∏—Ç–∏—á–Ω–∞ –ª–∏ –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è?}
    B -->|–î–∞| C{–¢—Ä–µ–±—É–µ—Ç—Å—è –ª–∏ –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è?}
    C -->|–î–∞| D[ES+CQRS]
    C -->|–ù–µ—Ç| E[–ß–∏—Å—Ç—ã–π Event Sourcing]
    B -->|–ù–µ—Ç| F[–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è SAGA]
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠–≤–æ–ª—é—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —É—Å–ª–æ–∂–Ω–µ–Ω–∏—è:

1. –ù–∞—á–Ω–∏—Ç–µ —Å **SAGA** –¥–ª—è –±–∞–∑–æ–≤–æ–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏
2. –î–æ–±–∞–≤—å—Ç–µ **Event Sourcing** –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –¥–æ–º–µ–Ω–æ–≤
3. –í–Ω–µ–¥—Ä–∏—Ç–µ **CQRS** –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
4. –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ **ES+CQRS** –≤ —Å–ª–æ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö

> **–ì–ª–∞–≤–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø:** –í—ã–±–∏—Ä–∞–π—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤–∞—à–∏–º —Ä–µ–∞–ª—å–Ω—ã–º –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º, –∞ –Ω–µ —Ç—Ä–µ–Ω–¥–∞–º.